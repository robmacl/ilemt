Todo:

Accuracy:
 -- Try variations of source and sensor coil and fixture
 -- Try coupling offset compensation using shorted input data
 -- Visualize/test fields generated by forward kinematics
 -- Test RxRy fixture accuracy
 -- Mag shield for input cards
 -- Accuracy papers

What to do for accuracy?
 -- Try the easily available source/sensor combinations
 -- Try the quadrupole
 -- Normalization/weighting/sensitivity
 -- does error vary with distance/strength?  Mixed results previously
 -- Axis sweep linearity
 -- Try low-rate calibration
 -- Try coupling bias
 -- Investigate whether ground truth is limiting observable accuracy
 -- Investigate possible magnetic interference from stage setup
 -- Other more ad-hoc calibration parameters?


Experiments:
Source/sensor configuration variations:

Sensors:
    se_dipole
    Premo concentric cube
    se_dipole_linear?
    Premo compact?

Sources:
    so_dipole_corner
    so_dipole_corner_rotated
    so_dipole_linear
    CMU concentric cube
    Premo concentric?


Paper ideas:

Current aim is the cross-coupling paper.  For that we need some extra
experiments and simulations to get at the mechanism and magnitude.  Literature
search.  three-axis magnetometer calibration

[cross-coupling]
  Source-source and sensor-sensor coil coupling can be big problems
   - Depends on concentric vs. non, sensor loading, whether source coils are
     driven simultaneously.
   - Ferrite core problematic with non-concentric coils
   - Source coupling is a big issue with FDM, and probably not with TDM,
     depending on driver details.
   - Can use current sense to reduce source coil coupling
   - Can also minimize coupling through concentric coils or non-concentric
     arrangements. 
   - Need to establish these claims somehow.  Simply using calibration accuracy
     experiments is not very good because there is not a simple causal
     relation.  Given eg. field map or simulations, can be presented as more
     general than ILEMT, and not needing a lot of ILEMT context.
   - 2D FEMM XY simulation?  Not accurate, but a good visualization
   - There are enough points that it can't be a short paper

[calibration]
  ILEMT calibration accuracy report:
   - We have this thing which has some kind of accuracy
   - Background on project
   - Calibration and test methods
   - Sensitivity of the pose solution to coupling error?  Possible short paper
     in itself.
   - Not an omnibus all-the-results paper, without: dynamic and noise
     performance, metal rejection, in-vivo accuracy compared to ASAP, EMI
     tolerance, etc.
   - If you don't think about those omissions, then this can resemble the
     journal standard of being the final results on a project.  It is (we
     hope) a wrap-up within the limited scope of static accuracy w/o
     interference. 
   - Need to resolve cross-coupling issues first, and get the best accuracy we
     can easily get.  Try the concentric source/sensor
   - No emphasis on the dipole-approximating coil (especially if it isn't used
     for our headline results).

[quadrupole]
  Dipole/quadrupole story (tentative because of coil interactions, and weird
  quadrupole fit):
   - Dipole-approx coil fairly accurate
   - Dipole performance may be limited by cross-coupling.  Use the best
     dipole-approximating source arrangement, reference [cross-coupling].
   - Quadrupole can help a bit
   - This is a plausible tidy result, possible short paper.
   - Show model deviation in the coupling space, not just pose accuracy.
     Sensitivity of pose solution.
   - Discussing pose accuracy needs the ILEMT context. Needs to reference
     [calibration]

[system]
  Hardware description, signal processing, noise and dynamics performance.
  Accuracy update.
   - Need to mention high/low motivation, but no evaluation here

[high/low metal]
  Description and performance of high/low eddy current rejection.  Possible
  ferromagnetic compensation, or at least detection.


calibrate_main
>> calibrate_main

cal_mode =

    'so_quadrupole_all'


sensor =

    'dipole'


base_calibration =

    'so_quadrupole_hr_cal'


optimize =

  1×8 cell array

    {'q_so_pos'}    {'q_so_mo'}    {'d_so_pos'}    {'d_so_mo'}    {'d_se_pos'}    {'d_se_mo'}    {'so_fix'}    {'se_fix'}

D:\ilemt\cal_data\cal_5_13_dipole_cmu

                                         Norm of      First-order 
 Iteration  Func-count     f(x)          step          optimality
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    _____________________________________    ________________________________________    ______________________________________

    -0.0015945     0.0002228             0    0.75286       0.024297              0      0.013822    -0.00039809              0       0.45147    -0.0072535             0
    0.00048023     -0.001007             0          0        0.89164              0    0.00020174       0.013526              0             0       0.44989             0
     0.0013637     0.0013192             0    0.03679    -0.00037367              1     -0.013897      -0.013594              0    -0.0078329     0.0029856       0.44925

                  q_source_pos                             q_source_moment              q_sensor_pos    q_sensor_moment
    _________________________________________    ___________________________________    ____________    _______________

      -0.086413       0.089725       0.024497    -3.7817      0.016741      0.046714    0    0    0       0    0    0  
       0.014707      -0.076931       0.050617     1.0026     -0.021661    -0.0018915    0    0    0       0    0    0  
    -0.00042169       0.015891       -0.03218     1.2733    0.00091775       0.12646    0    0    0       0    0    0  

Source fix: [0.27578 0.00975 0.01608 0.02747 0.04873 -1.62545 ]
Sensor fix: [0.00008 0.00002 0.01369 0.00861 -0.00708 1.55802 ]
     0         54       0.0106749                         0.133
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    _____________________________________    ________________________________________    ______________________________________

    -0.0015945     0.0002228             0    0.75286       0.024297              0      0.013822    -0.00039809              0       0.45147    -0.0072535             0
    0.00048023     -0.001007             0          0        0.89164              0    0.00020174       0.013526              0             0       0.44989             0
     0.0013637     0.0013192             0    0.03679    -0.00037367              1     -0.013897      -0.013594              0    -0.0078329     0.0029856       0.44925

                  q_source_pos                             q_source_moment              q_sensor_pos    q_sensor_moment
    _________________________________________    ___________________________________    ____________    _______________

      -0.086413       0.089725       0.024497    -3.7817      0.016741      0.046714    0    0    0       0    0    0  
       0.014707      -0.076931       0.050617     1.0026     -0.021661    -0.0018915    0    0    0       0    0    0  
    -0.00042169       0.015891       -0.03218     1.2733    0.00091775       0.12646    0    0    0       0    0    0  

Source fix: [0.27578 0.00975 0.01608 0.02747 0.04873 -1.62545 ]
Sensor fix: [0.00008 0.00002 0.01369 0.00861 -0.00708 1.55802 ]
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    _____________________________________    ________________________________________    ______________________________________

    -0.0015945     0.0002228             0    0.75286       0.024297              0      0.013822    -0.00039809              0       0.45147    -0.0072535             0
    0.00048023     -0.001007             0          0        0.89164              0    0.00020174       0.013526              0             0       0.44989             0
     0.0013637     0.0013192             0    0.03679    -0.00037367              1     -0.013897      -0.013594              0    -0.0078329     0.0029856       0.44925

                  q_source_pos                             q_source_moment              q_sensor_pos    q_sensor_moment
    _________________________________________    ___________________________________    ____________    _______________

      -0.086413       0.089725       0.024497    -3.7817      0.016741      0.046714    0    0    0       0    0    0  
       0.014707      -0.076931       0.050617     1.0026     -0.021661    -0.0018915    0    0    0       0    0    0  
    -0.00042169       0.015891       -0.03218     1.2733    0.00091775       0.12646    0    0    0       0    0    0  

Source fix: [0.27578 0.00975 0.01608 0.02747 0.04873 -1.62545 ]
Sensor fix: [0.00008 0.00002 0.01369 0.00861 -0.00708 1.55802 ]
     1        108       0.0106749        5.41235          0.133      
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    _____________________________________    ________________________________________    ______________________________________

    -0.0015945     0.0002228             0    0.75286       0.024297              0      0.013822    -0.00039809              0       0.45147    -0.0072535             0
    0.00048023     -0.001007             0          0        0.89164              0    0.00020174       0.013526              0             0       0.44989             0
     0.0013637     0.0013192             0    0.03679    -0.00037367              1     -0.013897      -0.013594              0    -0.0078329     0.0029856       0.44925

                  q_source_pos                             q_source_moment              q_sensor_pos    q_sensor_moment
    _________________________________________    ___________________________________    ____________    _______________

      -0.086413       0.089725       0.024497    -3.7817      0.016741      0.046714    0    0    0       0    0    0  
       0.014707      -0.076931       0.050617     1.0026     -0.021661    -0.0018915    0    0    0       0    0    0  
    -0.00042169       0.015891       -0.03218     1.2733    0.00091775       0.12646    0    0    0       0    0    0  

Source fix: [0.27578 0.00975 0.01608 0.02747 0.04873 -1.62545 ]
Sensor fix: [0.00008 0.00002 0.01369 0.00861 -0.00708 1.55802 ]
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    _____________________________________    ________________________________________    ______________________________________

    -0.0015945     0.0002228             0    0.75286       0.024297              0      0.013822    -0.00039809              0       0.45147    -0.0072535             0
    0.00048023     -0.001007             0          0        0.89164              0    0.00020174       0.013526              0             0       0.44989             0
     0.0013637     0.0013192             0    0.03679    -0.00037367              1     -0.013897      -0.013594              0    -0.0078329     0.0029856       0.44925

                  q_source_pos                             q_source_moment              q_sensor_pos    q_sensor_moment
    _________________________________________    ___________________________________    ____________    _______________

      -0.086413       0.089725       0.024497    -3.7817      0.016741      0.046714    0    0    0       0    0    0  
       0.014707      -0.076931       0.050617     1.0026     -0.021661    -0.0018915    0    0    0       0    0    0  
    -0.00042169       0.015891       -0.03218     1.2733    0.00091775       0.12646    0    0    0       0    0    0  

Source fix: [0.27578 0.00975 0.01608 0.02747 0.04873 -1.62545 ]
Sensor fix: [0.00008 0.00002 0.01369 0.00861 -0.00708 1.55802 ]
     2        162       0.0106749        1.35309          0.133      
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    _____________________________________    ________________________________________    ______________________________________

    -0.0015945     0.0002228             0    0.75286       0.024297              0      0.013822    -0.00039809              0       0.45147    -0.0072535             0
    0.00048023     -0.001007             0          0        0.89164              0    0.00020174       0.013526              0             0       0.44989             0
     0.0013637     0.0013192             0    0.03679    -0.00037367              1     -0.013897      -0.013594              0    -0.0078329     0.0029856       0.44925

                  q_source_pos                             q_source_moment              q_sensor_pos    q_sensor_moment
    _________________________________________    ___________________________________    ____________    _______________

      -0.086413       0.089725       0.024497    -3.7817      0.016741      0.046714    0    0    0       0    0    0  
       0.014707      -0.076931       0.050617     1.0026     -0.021661    -0.0018915    0    0    0       0    0    0  
    -0.00042169       0.015891       -0.03218     1.2733    0.00091775       0.12646    0    0    0       0    0    0  

Source fix: [0.27578 0.00975 0.01608 0.02747 0.04873 -1.62545 ]
Sensor fix: [0.00008 0.00002 0.01369 0.00861 -0.00708 1.55802 ]
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    _____________________________________    ________________________________________    ______________________________________

    -0.0015945     0.0002228             0    0.75286       0.024297              0      0.013822    -0.00039809              0       0.45147    -0.0072535             0
    0.00048023     -0.001007             0          0        0.89164              0    0.00020174       0.013526              0             0       0.44989             0
     0.0013637     0.0013192             0    0.03679    -0.00037367              1     -0.013897      -0.013594              0    -0.0078329     0.0029856       0.44925

                  q_source_pos                             q_source_moment              q_sensor_pos    q_sensor_moment
    _________________________________________    ___________________________________    ____________    _______________

      -0.086413       0.089725       0.024497    -3.7817      0.016741      0.046714    0    0    0       0    0    0  
       0.014707      -0.076931       0.050617     1.0026     -0.021661    -0.0018915    0    0    0       0    0    0  
    -0.00042169       0.015891       -0.03218     1.2733    0.00091775       0.12646    0    0    0       0    0    0  

Source fix: [0.27578 0.00975 0.01608 0.02747 0.04873 -1.62545 ]
Sensor fix: [0.00008 0.00002 0.01369 0.00861 -0.00708 1.55802 ]
     3        216       0.0106462       0.338272          0.455      
                 d_source_pos                            d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    ________________________________________    ______________________________________

    -0.0015904      0.000339             0     0.75337       0.021542              0      0.013819    -0.00039388              0       0.45182    -0.0072595             0
    0.00057062    -0.0010526             0           0        0.89139              0    0.00020043       0.013522              0             0       0.45024             0
     0.0016917     0.0013819             0    0.032291    -0.00047387              1     -0.013892      -0.013591              0    -0.0078365      0.002992        0.4496

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

      -0.08222      0.085184      0.024111    -3.5516     0.019603     0.051732    0    0    0       0    0    0  
      0.013828     -0.076332      0.041858    0.86753    -0.026022    0.0026411    0    0    0       0    0    0  
    -0.0026869       0.01556     -0.029762     1.0665    0.0010199      0.14114    0    0    0       0    0    0  

Source fix: [0.27589 0.01059 0.01615 0.02727 0.04867 -1.62245 ]
Sensor fix: [0.00009 0.00001 0.01369 0.00861 -0.00707 1.55802 ]
                 d_source_pos                            d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    ________________________________________    ______________________________________

    -0.0015904      0.000339             0     0.75337       0.021542              0      0.013819    -0.00039388              0       0.45182    -0.0072595             0
    0.00057062    -0.0010526             0           0        0.89139              0    0.00020043       0.013522              0             0       0.45024             0
     0.0016917     0.0013819             0    0.032291    -0.00047387              1     -0.013892      -0.013591              0    -0.0078365      0.002992        0.4496

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

      -0.08222      0.085184      0.024111    -3.5516     0.019603     0.051732    0    0    0       0    0    0  
      0.013828     -0.076332      0.041858    0.86753    -0.026022    0.0026411    0    0    0       0    0    0  
    -0.0026869       0.01556     -0.029762     1.0665    0.0010199      0.14114    0    0    0       0    0    0  

Source fix: [0.27589 0.01059 0.01615 0.02727 0.04867 -1.62245 ]
Sensor fix: [0.00009 0.00001 0.01369 0.00861 -0.00707 1.55802 ]
     4        270       0.0106261       0.338272          0.474      
                 d_source_pos                            d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    ________________________________________    ______________________________________

    -0.0015794     0.0005031             0     0.75409       0.018566              0       0.01382    -0.00039191              0       0.45226    -0.0072662             0
     0.0006723    -0.0010965             0           0        0.89098              0    0.00020077       0.013522              0             0       0.45068             0
     0.0020679      0.001482             0    0.027851    -0.00058345              1     -0.013888      -0.013587              0    -0.0078418     0.0029983       0.45004

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.077319      0.080495      0.023616      -3.31     0.023028     0.058394    0    0    0       0    0    0  
      0.012732     -0.075531      0.032945    0.72963    -0.031436     0.008196    0    0    0       0    0    0  
    -0.0049544      0.015228     -0.027371     0.8762    0.0011338      0.16472    0    0    0       0    0    0  

Source fix: [0.27605 0.01151 0.01625 0.02706 0.04859 -1.61919 ]
Sensor fix: [0.00008 0.00002 0.01369 0.00861 -0.00707 1.55802 ]
                 d_source_pos                            d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    ________________________________________    ______________________________________

    -0.0015794     0.0005031             0     0.75409       0.018566              0       0.01382    -0.00039191              0       0.45226    -0.0072662             0
     0.0006723    -0.0010965             0           0        0.89098              0    0.00020077       0.013522              0             0       0.45068             0
     0.0020679      0.001482             0    0.027851    -0.00058345              1     -0.013888      -0.013587              0    -0.0078418     0.0029983       0.45004

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.077319      0.080495      0.023616      -3.31     0.023028     0.058394    0    0    0       0    0    0  
      0.012732     -0.075531      0.032945    0.72963    -0.031436     0.008196    0    0    0       0    0    0  
    -0.0049544      0.015228     -0.027371     0.8762    0.0011338      0.16472    0    0    0       0    0    0  

Source fix: [0.27605 0.01151 0.01625 0.02706 0.04859 -1.61919 ]
Sensor fix: [0.00008 0.00002 0.01369 0.00861 -0.00707 1.55802 ]
     5        324       0.0106076       0.338272          0.533      
                 d_source_pos                            d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    ________________________________________    ______________________________________

    -0.0015677    0.00072168             0     0.75499       0.015315              0      0.013822    -0.00039013              0       0.45282    -0.0072745             0
    0.00078029    -0.0011462             0           0        0.89036              0    0.00020004       0.013522              0             0       0.45124             0
     0.0025151     0.0016343             0    0.023467    -0.00068812              1     -0.013883      -0.013584              0    -0.0078492     0.0030055       0.45061

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.071476      0.075475      0.023389    -3.0578     0.027289     0.066528    0    0    0       0    0    0  
      0.011292     -0.074468       0.02461    0.58802    -0.038453     0.014348    0    0    0       0    0    0  
    -0.0071458      0.014886     -0.024999    0.70509    0.0012632      0.19841    0    0    0       0    0    0  

Source fix: [0.27625 0.01251 0.01641 0.02682 0.04854 -1.61564 ]
Sensor fix: [0.00008 0.00002 0.01369 0.00860 -0.00707 1.55802 ]
                 d_source_pos                            d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    ________________________________________    ______________________________________

    -0.0015677    0.00072168             0     0.75499       0.015315              0      0.013822    -0.00039013              0       0.45282    -0.0072745             0
    0.00078029    -0.0011462             0           0        0.89036              0    0.00020004       0.013522              0             0       0.45124             0
     0.0025151     0.0016343             0    0.023467    -0.00068812              1     -0.013883      -0.013584              0    -0.0078492     0.0030055       0.45061

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.071476      0.075475      0.023389    -3.0578     0.027289     0.066528    0    0    0       0    0    0  
      0.011292     -0.074468       0.02461    0.58802    -0.038453     0.014348    0    0    0       0    0    0  
    -0.0071458      0.014886     -0.024999    0.70509    0.0012632      0.19841    0    0    0       0    0    0  

Source fix: [0.27625 0.01251 0.01641 0.02682 0.04854 -1.61564 ]
Sensor fix: [0.00008 0.00002 0.01369 0.00860 -0.00707 1.55802 ]
     6        378       0.0105777       0.338272          0.594      
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    _______________________________________    ______________________________________

    -0.0015787     0.0010007             0     0.75613       0.011706              0     0.013823    -0.00038944              0       0.45353    -0.0072848             0
    0.00089222    -0.0012139             0           0        0.88952              0    0.0001978        0.01352              0             0       0.45195             0
     0.0030603     0.0018513             0    0.019151    -0.00076604              1     -0.01388      -0.013582              0    -0.0078589      0.003014       0.45133

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.064261      0.069811      0.023722    -2.7952       0.0329     0.076013    0    0    0       0    0    0  
     0.0093038     -0.073022      0.017529    0.44172    -0.048159     0.020075    0    0    0       0    0    0  
    -0.0090479      0.014504     -0.022743    0.55811    0.0014144      0.24279    0    0    0       0    0    0  

Source fix: [0.27651 0.01362 0.01662 0.02654 0.04854 -1.61168 ]
Sensor fix: [0.00008 0.00001 0.01368 0.00860 -0.00706 1.55802 ]
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    _______________________________________    ______________________________________

    -0.0015787     0.0010007             0     0.75613       0.011706              0     0.013823    -0.00038944              0       0.45353    -0.0072848             0
    0.00089222    -0.0012139             0           0        0.88952              0    0.0001978        0.01352              0             0       0.45195             0
     0.0030603     0.0018513             0    0.019151    -0.00076604              1     -0.01388      -0.013582              0    -0.0078589      0.003014       0.45133

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.064261      0.069811      0.023722    -2.7952       0.0329     0.076013    0    0    0       0    0    0  
     0.0093038     -0.073022      0.017529    0.44172    -0.048159     0.020075    0    0    0       0    0    0  
    -0.0090479      0.014504     -0.022743    0.55811    0.0014144      0.24279    0    0    0       0    0    0  

Source fix: [0.27651 0.01362 0.01662 0.02654 0.04854 -1.61168 ]
Sensor fix: [0.00008 0.00001 0.01368 0.00860 -0.00706 1.55802 ]
     7        432       0.0105598       0.338272          0.758      
                 d_source_pos                            d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    ________________________________________    ______________________________________

    -0.0016874     0.0013538             0     0.75768       0.007614              0      0.013825    -0.00038757              0       0.45445    -0.0072982             0
     0.0010217    -0.0013275             0           0        0.88839              0    0.00019739       0.013521              0             0       0.45288             0
     0.0037569     0.0021404             0    0.014916    -0.00079741              1     -0.013876      -0.013579              0    -0.0078715     0.0030245       0.45225

               q_source_pos                         q_source_moment             q_sensor_pos    q_sensor_moment
    ___________________________________    _________________________________    ____________    _______________

    -0.054688     0.062879     0.024831    -2.5216      0.04101     0.087153    0    0    0       0    0    0  
    0.0064799    -0.070904     0.011984    0.29011    -0.063099     0.024101    0    0    0       0    0    0  
    -0.010083     0.014007     -0.02073    0.44462    0.0015992      0.29795    0    0    0       0    0    0  

Source fix: [0.27684 0.01486 0.01688 0.02622 0.04865 -1.60719 ]
Sensor fix: [0.00008 0.00001 0.01368 0.00859 -0.00706 1.55802 ]
                 d_source_pos                            d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    ________________________________________    ______________________________________

    -0.0016874     0.0013538             0     0.75768       0.007614              0      0.013825    -0.00038757              0       0.45445    -0.0072982             0
     0.0010217    -0.0013275             0           0        0.88839              0    0.00019739       0.013521              0             0       0.45288             0
     0.0037569     0.0021404             0    0.014916    -0.00079741              1     -0.013876      -0.013579              0    -0.0078715     0.0030245       0.45225

               q_source_pos                         q_source_moment             q_sensor_pos    q_sensor_moment
    ___________________________________    _________________________________    ____________    _______________

    -0.054688     0.062879     0.024831    -2.5216      0.04101     0.087153    0    0    0       0    0    0  
    0.0064799    -0.070904     0.011984    0.29011    -0.063099     0.024101    0    0    0       0    0    0  
    -0.010083     0.014007     -0.02073    0.44462    0.0015992      0.29795    0    0    0       0    0    0  

Source fix: [0.27684 0.01486 0.01688 0.02622 0.04865 -1.60719 ]
Sensor fix: [0.00008 0.00001 0.01368 0.00859 -0.00706 1.55802 ]
     8        486       0.0105047      0.0845679          0.744      
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    _______________________________________    ______________________________________

    -0.0018007     0.0014845             0     0.75829      0.0063793              0     0.013824    -0.00038824              0        0.4548    -0.0073032             0
     0.0010603    -0.0013809             0           0        0.88797              0    0.0001966       0.013519              0             0       0.45322             0
     0.0040193     0.0022429             0    0.013811    -0.00078947              1    -0.013874      -0.013578              0    -0.0078761     0.0030283        0.4526

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.050855      0.060301      0.025391    -2.4517     0.044669     0.091015    0    0    0       0    0    0  
     0.0054545     -0.069944      0.010873    0.25021    -0.070463     0.024459    0    0    0       0    0    0  
    -0.0096789      0.013796     -0.020263    0.42949    0.0016642      0.31631    0    0    0       0    0    0  

Source fix: [0.27696 0.01523 0.01696 0.02612 0.04871 -1.60583 ]
Sensor fix: [0.00008 0.00001 0.01368 0.00859 -0.00706 1.55802 ]
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    _______________________________________    ______________________________________

    -0.0018007     0.0014845             0     0.75829      0.0063793              0     0.013824    -0.00038824              0        0.4548    -0.0073032             0
     0.0010603    -0.0013809             0           0        0.88797              0    0.0001966       0.013519              0             0       0.45322             0
     0.0040193     0.0022429             0    0.013811    -0.00078947              1    -0.013874      -0.013578              0    -0.0078761     0.0030283        0.4526

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.050855      0.060301      0.025391    -2.4517     0.044669     0.091015    0    0    0       0    0    0  
     0.0054545     -0.069944      0.010873    0.25021    -0.070463     0.024459    0    0    0       0    0    0  
    -0.0096789      0.013796     -0.020263    0.42949    0.0016642      0.31631    0    0    0       0    0    0  

Source fix: [0.27696 0.01523 0.01696 0.02612 0.04871 -1.60583 ]
Sensor fix: [0.00008 0.00001 0.01368 0.00859 -0.00706 1.55802 ]
     9        540       0.0104739       0.169136          0.719      
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    _______________________________________    ______________________________________

    -0.0022034     0.0018014             0     0.75975      0.0036247              0     0.013823    -0.00038679              0       0.45566    -0.0073165             0
     0.0011777    -0.0015378             0           0        0.88694              0    0.0001967       0.013517              0             0       0.45408             0
     0.0047064     0.0024906             0    0.011364    -0.00076183              1    -0.013872      -0.013576              0    -0.0078879     0.0030387       0.45346

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.041228      0.054007      0.026766    -2.3161     0.054299      0.10061    0    0    0       0    0    0  
     0.0031383      -0.06743     0.0085698    0.16611    -0.090643     0.024862    0    0    0       0    0    0  
    -0.0080427      0.013263      -0.01925    0.40925    0.0018126      0.36053    0    0    0       0    0    0  

Source fix: [0.27728 0.01605 0.01716 0.02586 0.04888 -1.60279 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00706 1.55803 ]
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    _______________________________________    ______________________________________

    -0.0022034     0.0018014             0     0.75975      0.0036247              0     0.013823    -0.00038679              0       0.45566    -0.0073165             0
     0.0011777    -0.0015378             0           0        0.88694              0    0.0001967       0.013517              0             0       0.45408             0
     0.0047064     0.0024906             0    0.011364    -0.00076183              1    -0.013872      -0.013576              0    -0.0078879     0.0030387       0.45346

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.041228      0.054007      0.026766    -2.3161     0.054299      0.10061    0    0    0       0    0    0  
     0.0031383      -0.06743     0.0085698    0.16611    -0.090643     0.024862    0    0    0       0    0    0  
    -0.0080427      0.013263      -0.01925    0.40925    0.0018126      0.36053    0    0    0       0    0    0  

Source fix: [0.27728 0.01605 0.01716 0.02586 0.04888 -1.60279 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00706 1.55803 ]
    10        594       0.0104739       0.169136          0.719      
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    _______________________________________    ______________________________________

    -0.0022034     0.0018014             0     0.75975      0.0036247              0     0.013823    -0.00038679              0       0.45566    -0.0073165             0
     0.0011777    -0.0015378             0           0        0.88694              0    0.0001967       0.013517              0             0       0.45408             0
     0.0047064     0.0024906             0    0.011364    -0.00076183              1    -0.013872      -0.013576              0    -0.0078879     0.0030387       0.45346

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.041228      0.054007      0.026766    -2.3161     0.054299      0.10061    0    0    0       0    0    0  
     0.0031383      -0.06743     0.0085698    0.16611    -0.090643     0.024862    0    0    0       0    0    0  
    -0.0080427      0.013263      -0.01925    0.40925    0.0018126      0.36053    0    0    0       0    0    0  

Source fix: [0.27728 0.01605 0.01716 0.02586 0.04888 -1.60279 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00706 1.55803 ]
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    _______________________________________    ______________________________________

    -0.0022034     0.0018014             0     0.75975      0.0036247              0     0.013823    -0.00038679              0       0.45566    -0.0073165             0
     0.0011777    -0.0015378             0           0        0.88694              0    0.0001967       0.013517              0             0       0.45408             0
     0.0047064     0.0024906             0    0.011364    -0.00076183              1    -0.013872      -0.013576              0    -0.0078879     0.0030387       0.45346

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.041228      0.054007      0.026766    -2.3161     0.054299      0.10061    0    0    0       0    0    0  
     0.0031383      -0.06743     0.0085698    0.16611    -0.090643     0.024862    0    0    0       0    0    0  
    -0.0080427      0.013263      -0.01925    0.40925    0.0018126      0.36053    0    0    0       0    0    0  

Source fix: [0.27728 0.01605 0.01716 0.02586 0.04888 -1.60279 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00706 1.55803 ]
    11        648       0.0103932       0.042284          0.323      
                 d_source_pos                            d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    ________________________________________    ______________________________________

    -0.0026504     0.0019943             0     0.76039      0.0025175              0      0.013822    -0.00038617              0       0.45615    -0.0073234             0
     0.0012059    -0.0016207             0           0        0.88637              0    0.00019703       0.013513              0             0       0.45457             0
     0.0051492     0.0026267             0    0.010293    -0.00073776              1     -0.013871      -0.013573              0    -0.0078941     0.0030442       0.45396

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.035774      0.050439      0.027495    -2.3118     0.060812      0.10619    0    0    0       0    0    0  
     0.0022679     -0.065736     0.0077334    0.13891     -0.10577     0.024629    0    0    0       0    0    0  
    -0.0063453       0.01293     -0.018824    0.41945    0.0018791      0.38433    0    0    0       0    0    0  

Source fix: [0.27747 0.01637 0.01727 0.02573 0.04899 -1.60156 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00706 1.55803 ]
                 d_source_pos                            d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    ________________________________________    ______________________________________

    -0.0026504     0.0019943             0     0.76039      0.0025175              0      0.013822    -0.00038617              0       0.45615    -0.0073234             0
     0.0012059    -0.0016207             0           0        0.88637              0    0.00019703       0.013513              0             0       0.45457             0
     0.0051492     0.0026267             0    0.010293    -0.00073776              1     -0.013871      -0.013573              0    -0.0078941     0.0030442       0.45396

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.035774      0.050439      0.027495    -2.3118     0.060812      0.10619    0    0    0       0    0    0  
     0.0022679     -0.065736     0.0077334    0.13891     -0.10577     0.024629    0    0    0       0    0    0  
    -0.0063453       0.01293     -0.018824    0.41945    0.0018791      0.38433    0    0    0       0    0    0  

Source fix: [0.27747 0.01637 0.01727 0.02573 0.04899 -1.60156 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00706 1.55803 ]
    12        702       0.0103932      0.0845679          0.323      
                 d_source_pos                            d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    ________________________________________    ______________________________________

    -0.0026504     0.0019943             0     0.76039      0.0025175              0      0.013822    -0.00038617              0       0.45615    -0.0073234             0
     0.0012059    -0.0016207             0           0        0.88637              0    0.00019703       0.013513              0             0       0.45457             0
     0.0051492     0.0026267             0    0.010293    -0.00073776              1     -0.013871      -0.013573              0    -0.0078941     0.0030442       0.45396

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.035774      0.050439      0.027495    -2.3118     0.060812      0.10619    0    0    0       0    0    0  
     0.0022679     -0.065736     0.0077334    0.13891     -0.10577     0.024629    0    0    0       0    0    0  
    -0.0063453       0.01293     -0.018824    0.41945    0.0018791      0.38433    0    0    0       0    0    0  

Source fix: [0.27747 0.01637 0.01727 0.02573 0.04899 -1.60156 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00706 1.55803 ]
                 d_source_pos                            d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    ______________________________________    ________________________________________    ______________________________________

    -0.0026504     0.0019943             0     0.76039      0.0025175              0      0.013822    -0.00038617              0       0.45615    -0.0073234             0
     0.0012059    -0.0016207             0           0        0.88637              0    0.00019703       0.013513              0             0       0.45457             0
     0.0051492     0.0026267             0    0.010293    -0.00073776              1     -0.013871      -0.013573              0    -0.0078941     0.0030442       0.45396

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.035774      0.050439      0.027495    -2.3118     0.060812      0.10619    0    0    0       0    0    0  
     0.0022679     -0.065736     0.0077334    0.13891     -0.10577     0.024629    0    0    0       0    0    0  
    -0.0063453       0.01293     -0.018824    0.41945    0.0018791      0.38433    0    0    0       0    0    0  

Source fix: [0.27747 0.01637 0.01727 0.02573 0.04899 -1.60156 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00706 1.55803 ]
    13        756       0.0103768       0.021142          0.203      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0028483     0.0020548             0      0.76053      0.0022331              0      0.013822    -0.00038539              0       0.45631    -0.0073261             0
     0.0012234    -0.0016542             0            0        0.88618              0    0.00019689       0.013513              0             0       0.45473             0
     0.0053127     0.0026699             0    0.0099794    -0.00072918              1      -0.01387      -0.013573              0    -0.0078963     0.0030463       0.45412

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

      -0.03413      0.049322       0.02771    -2.3283     0.063077      0.10803    0    0    0       0    0    0  
     0.0020705     -0.065149     0.0075139      0.133      -0.1114     0.024525    0    0    0       0    0    0  
    -0.0057482      0.012821     -0.018703    0.42564    0.0018938      0.39194    0    0    0       0    0    0  

Source fix: [0.27754 0.01645 0.01730 0.02569 0.04902 -1.60125 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00706 1.55803 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0028483     0.0020548             0      0.76053      0.0022331              0      0.013822    -0.00038539              0       0.45631    -0.0073261             0
     0.0012234    -0.0016542             0            0        0.88618              0    0.00019689       0.013513              0             0       0.45473             0
     0.0053127     0.0026699             0    0.0099794    -0.00072918              1      -0.01387      -0.013573              0    -0.0078963     0.0030463       0.45412

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

      -0.03413      0.049322       0.02771    -2.3283     0.063077      0.10803    0    0    0       0    0    0  
     0.0020705     -0.065149     0.0075139      0.133      -0.1114     0.024525    0    0    0       0    0    0  
    -0.0057482      0.012821     -0.018703    0.42564    0.0018938      0.39194    0    0    0       0    0    0  

Source fix: [0.27754 0.01645 0.01730 0.02569 0.04902 -1.60125 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00706 1.55803 ]
    14        810       0.0103682       0.042284          0.621      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0031894     0.0021515             0      0.76071      0.0018091              0      0.013821    -0.00038571              0       0.45656    -0.0073301             0
     0.0012531    -0.0017148             0            0        0.88589              0    0.00019717       0.013513              0             0       0.45499             0
     0.0055851     0.0027389             0    0.0094881    -0.00071504              1     -0.013869      -0.013571              0    -0.0078997     0.0030494       0.45437

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.031574      0.047554      0.028046    -2.3646     0.066786      0.11101    0    0    0       0    0    0  
     0.0017903     -0.064191      0.007181    0.12471     -0.12086     0.024349    0    0    0       0    0    0  
    -0.0047859      0.012647     -0.018515    0.43692    0.0019126      0.40414    0    0    0       0    0    0  

Source fix: [0.27763 0.01657 0.01735 0.02563 0.04907 -1.60077 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00706 1.55803 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0031894     0.0021515             0      0.76071      0.0018091              0      0.013821    -0.00038571              0       0.45656    -0.0073301             0
     0.0012531    -0.0017148             0            0        0.88589              0    0.00019717       0.013513              0             0       0.45499             0
     0.0055851     0.0027389             0    0.0094881    -0.00071504              1     -0.013869      -0.013571              0    -0.0078997     0.0030494       0.45437

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.031574      0.047554      0.028046    -2.3646     0.066786      0.11101    0    0    0       0    0    0  
     0.0017903     -0.064191      0.007181    0.12471     -0.12086     0.024349    0    0    0       0    0    0  
    -0.0047859      0.012647     -0.018515    0.43692    0.0019126      0.40414    0    0    0       0    0    0  

Source fix: [0.27763 0.01657 0.01735 0.02563 0.04907 -1.60077 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00706 1.55803 ]
    15        864       0.0103533       0.042284          0.365      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0034823     0.0022205             0      0.76079      0.0015338              0       0.01382    -0.00038508              0       0.45675    -0.0073332             0
     0.0012764    -0.0017621             0            0        0.88568              0    0.00019732       0.013513              0             0       0.45518             0
     0.0057975     0.0027894             0    0.0091389    -0.00070427              1     -0.013868       -0.01357              0    -0.0079023     0.0030518       0.45456

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.029824      0.046284      0.028281    -2.4035     0.069599      0.11324    0    0    0       0    0    0  
     0.0016253     -0.063468     0.0069574    0.11995     -0.12831     0.024213    0    0    0       0    0    0  
    -0.0040918      0.012521     -0.018384    0.44666    0.0019205      0.41313    0    0    0       0    0    0  

Source fix: [0.27771 0.01665 0.01739 0.02558 0.04911 -1.60046 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00705 1.55803 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0034823     0.0022205             0      0.76079      0.0015338              0       0.01382    -0.00038508              0       0.45675    -0.0073332             0
     0.0012764    -0.0017621             0            0        0.88568              0    0.00019732       0.013513              0             0       0.45518             0
     0.0057975     0.0027894             0    0.0091389    -0.00070427              1     -0.013868       -0.01357              0    -0.0079023     0.0030518       0.45456

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.029824      0.046284      0.028281    -2.4035     0.069599      0.11324    0    0    0       0    0    0  
     0.0016253     -0.063468     0.0069574    0.11995     -0.12831     0.024213    0    0    0       0    0    0  
    -0.0040918      0.012521     -0.018384    0.44666    0.0019205      0.41313    0    0    0       0    0    0  

Source fix: [0.27771 0.01665 0.01739 0.02558 0.04911 -1.60046 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00705 1.55803 ]
    16        918       0.0103411       0.042284          0.166      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0037515      0.002281             0      0.76082      0.0013244              0       0.01382    -0.00038487              0       0.45691    -0.0073357             0
     0.0012946    -0.0018017             0            0         0.8855              0    0.00019739       0.013512              0             0       0.45533             0
     0.0059816     0.0028316             0    0.0088532    -0.00069513              1     -0.013868      -0.013569              0    -0.0079044     0.0030538       0.45472

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.028462      0.045244       0.02847    -2.4433     0.071997      0.11511    0    0    0       0    0    0  
     0.0015095     -0.062854     0.0067824    0.11669     -0.13486     0.024096    0    0    0       0    0    0  
    -0.0035338      0.012416     -0.018278    0.45549    0.0019232      0.42064    0    0    0       0    0    0  

Source fix: [0.27778 0.01671 0.01742 0.02554 0.04915 -1.60022 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00705 1.55803 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0037515      0.002281             0      0.76082      0.0013244              0       0.01382    -0.00038487              0       0.45691    -0.0073357             0
     0.0012946    -0.0018017             0            0         0.8855              0    0.00019739       0.013512              0             0       0.45533             0
     0.0059816     0.0028316             0    0.0088532    -0.00069513              1     -0.013868      -0.013569              0    -0.0079044     0.0030538       0.45472

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.028462      0.045244       0.02847    -2.4433     0.071997      0.11511    0    0    0       0    0    0  
     0.0015095     -0.062854     0.0067824    0.11669     -0.13486     0.024096    0    0    0       0    0    0  
    -0.0035338      0.012416     -0.018278    0.45549    0.0019232      0.42064    0    0    0       0    0    0  

Source fix: [0.27778 0.01671 0.01742 0.02554 0.04915 -1.60022 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00858 -0.00705 1.55803 ]
    17        972       0.0103407      0.0845679          0.792      
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    _____________________________________    ________________________________________    ______________________________________

    -0.0042485     0.0023868             0      0.76082    0.00098328             0      0.013818    -0.00038504              0       0.45719    -0.0073402             0
     0.0013282    -0.0018752             0            0       0.88518             0    0.00019755       0.013512              0             0       0.45561             0
     0.0063143     0.0029061             0    0.0083561    -0.0006787             1     -0.013866      -0.013567              0    -0.0079081     0.0030572         0.455

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.026216      0.043436      0.028793    -2.5239       0.0763      0.11845    0    0    0       0    0    0  
     0.0013334     -0.061754     0.0064885    0.11185     -0.14691     0.023886    0    0    0       0    0    0  
    -0.0025913      0.012233     -0.018095     0.4719    0.0019217      0.43395    0    0    0       0    0    0  

Source fix: [0.27789 0.01680 0.01748 0.02548 0.04921 -1.59983 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00857 -0.00705 1.55803 ]
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    _____________________________________    ________________________________________    ______________________________________

    -0.0042485     0.0023868             0      0.76082    0.00098328             0      0.013818    -0.00038504              0       0.45719    -0.0073402             0
     0.0013282    -0.0018752             0            0       0.88518             0    0.00019755       0.013512              0             0       0.45561             0
     0.0063143     0.0029061             0    0.0083561    -0.0006787             1     -0.013866      -0.013567              0    -0.0079081     0.0030572         0.455

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.026216      0.043436      0.028793    -2.5239       0.0763      0.11845    0    0    0       0    0    0  
     0.0013334     -0.061754     0.0064885    0.11185     -0.14691     0.023886    0    0    0       0    0    0  
    -0.0025913      0.012233     -0.018095     0.4719    0.0019217      0.43395    0    0    0       0    0    0  

Source fix: [0.27789 0.01680 0.01748 0.02548 0.04921 -1.59983 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00857 -0.00705 1.55803 ]
    18       1026       0.0103259       0.021142          0.211      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0043668     0.0024086             0       0.7608     0.00092046              0      0.013818    -0.00038441              0       0.45725    -0.0073412             0
      0.001335    -0.0018916             0            0        0.88512              0    0.00019774       0.013512              0             0       0.45567             0
      0.006387      0.002922             0    0.0082518    -0.00067509              1     -0.013866      -0.013567              0    -0.0079089      0.003058       0.45506

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

      -0.02581      0.043059      0.028859    -2.5443     0.077249      0.11918    0    0    0       0    0    0  
     0.0013049     -0.061512      0.006431    0.11111     -0.14969      0.02384    0    0    0       0    0    0  
    -0.0024154      0.012194     -0.018058    0.47551    0.0019189      0.43681    0    0    0       0    0    0  

Source fix: [0.27792 0.01682 0.01749 0.02546 0.04922 -1.59976 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00857 -0.00705 1.55803 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0043668     0.0024086             0       0.7608     0.00092046              0      0.013818    -0.00038441              0       0.45725    -0.0073412             0
      0.001335    -0.0018916             0            0        0.88512              0    0.00019774       0.013512              0             0       0.45567             0
      0.006387      0.002922             0    0.0082518    -0.00067509              1     -0.013866      -0.013567              0    -0.0079089      0.003058       0.45506

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

      -0.02581      0.043059      0.028859    -2.5443     0.077249      0.11918    0    0    0       0    0    0  
     0.0013049     -0.061512      0.006431    0.11111     -0.14969      0.02384    0    0    0       0    0    0  
    -0.0024154      0.012194     -0.018058    0.47551    0.0019189      0.43681    0    0    0       0    0    0  

Source fix: [0.27792 0.01682 0.01749 0.02546 0.04922 -1.59976 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00857 -0.00705 1.55803 ]
    19       1080        0.010317       0.042284          0.246      
                d_source_pos                            d_source_moment                            d_sensor_pos                            d_sensor_moment            
    _____________________________________    _____________________________________    ______________________________________    ______________________________________

    -0.004595     0.0024559             0      0.76075    0.00080173             0      0.013817    -0.0003849             0       0.45736    -0.0073431             0
    0.0013477    -0.0019237             0            0       0.88499             0    0.00019763      0.013511             0             0       0.45579             0
    0.0065294     0.0029533             0    0.0080495    -0.0006681             1     -0.013865     -0.013565             0    -0.0079105     0.0030595       0.45517

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.025046      0.042331      0.028984    -2.5851     0.079107      0.12059    0    0    0       0    0    0  
     0.0012524      -0.06104     0.0063211    0.10977     -0.15518     0.023751    0    0    0       0    0    0  
    -0.0020814      0.012118     -0.017986    0.48257    0.0019125      0.44239    0    0    0       0    0    0  

Source fix: [0.27796 0.01685 0.01752 0.02544 0.04924 -1.59962 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00857 -0.00705 1.55803 ]
                d_source_pos                            d_source_moment                            d_sensor_pos                            d_sensor_moment            
    _____________________________________    _____________________________________    ______________________________________    ______________________________________

    -0.004595     0.0024559             0      0.76075    0.00080173             0      0.013817    -0.0003849             0       0.45736    -0.0073431             0
    0.0013477    -0.0019237             0            0       0.88499             0    0.00019763      0.013511             0             0       0.45579             0
    0.0065294     0.0029533             0    0.0080495    -0.0006681             1     -0.013865     -0.013565             0    -0.0079105     0.0030595       0.45517

                 q_source_pos                          q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    _________________________________    ____________    _______________

     -0.025046      0.042331      0.028984    -2.5851     0.079107      0.12059    0    0    0       0    0    0  
     0.0012524      -0.06104     0.0063211    0.10977     -0.15518     0.023751    0    0    0       0    0    0  
    -0.0020814      0.012118     -0.017986    0.48257    0.0019125      0.44239    0    0    0       0    0    0  

Source fix: [0.27796 0.01685 0.01752 0.02544 0.04924 -1.59962 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00857 -0.00705 1.55803 ]
    20       1134       0.0103098      0.0845679          0.389      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0050259     0.0025373             0      0.76062     0.00058511              0      0.013817    -0.00038453              0       0.45759    -0.0073467             0
     0.0013746    -0.0019887             0            0        0.88474              0    0.00019778       0.013511              0             0       0.45601             0
     0.0068018     0.0030131             0    0.0076602    -0.00065425              1     -0.013864      -0.013565              0    -0.0079136     0.0030623        0.4554

                 q_source_pos                         q_source_moment            q_sensor_pos    q_sensor_moment
    ______________________________________    _______________________________    ____________    _______________

     -0.023682      0.040939      0.029221     -2.667    0.082739     0.12335    0    0    0       0    0    0  
     0.0011612     -0.060118     0.0061153     0.1075    -0.16614    0.023579    0    0    0       0    0    0  
    -0.0014807      0.011974      -0.01785    0.49603    0.001896     0.45322    0    0    0       0    0    0  

Source fix: [0.27805 0.01692 0.01756 0.02538 0.04929 -1.59937 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00857 -0.00705 1.55803 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0050259     0.0025373             0      0.76062     0.00058511              0      0.013817    -0.00038453              0       0.45759    -0.0073467             0
     0.0013746    -0.0019887             0            0        0.88474              0    0.00019778       0.013511              0             0       0.45601             0
     0.0068018     0.0030131             0    0.0076602    -0.00065425              1     -0.013864      -0.013565              0    -0.0079136     0.0030623        0.4554

                 q_source_pos                         q_source_moment            q_sensor_pos    q_sensor_moment
    ______________________________________    _______________________________    ____________    _______________

     -0.023682      0.040939      0.029221     -2.667    0.082739     0.12335    0    0    0       0    0    0  
     0.0011612     -0.060118     0.0061153     0.1075    -0.16614    0.023579    0    0    0       0    0    0  
    -0.0014807      0.011974      -0.01785    0.49603    0.001896     0.45322    0    0    0       0    0    0  

Source fix: [0.27805 0.01692 0.01756 0.02538 0.04929 -1.59937 ]
Sensor fix: [0.00008 0.00001 0.01367 0.00857 -0.00705 1.55803 ]
    21       1188        0.010301      0.0845679          0.372      
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    _____________________________________    ________________________________________    ______________________________________

    -0.0054359     0.0026176             0      0.76042    0.00039657             0      0.013817    -0.00038425              0       0.45781    -0.0073502             0
     0.0013986    -0.0020541             0            0       0.88449             0    0.00019782       0.013511              0             0       0.45623             0
       0.00706     0.0030715             0    0.0072834    -0.0006405             1     -0.013863      -0.013564              0    -0.0079166      0.003065       0.45562

                  q_source_pos                            q_source_moment             q_sensor_pos    q_sensor_moment
    _________________________________________    _________________________________    ____________    _______________

      -0.022581       0.039612       0.029441     -2.749     0.086359      0.12607    0    0    0       0    0    0  
      0.0010878      -0.059203      0.0059278    0.10572     -0.17748     0.023411    0    0    0       0    0    0  
    -0.00099269       0.011834       -0.01772     0.5082    0.0018718      0.46384    0    0    0       0    0    0  

Source fix: [0.27815 0.01697 0.01761 0.02533 0.04934 -1.59915 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00857 -0.00705 1.55803 ]
                 d_source_pos                            d_source_moment                             d_sensor_pos                             d_sensor_moment            
    ______________________________________    _____________________________________    ________________________________________    ______________________________________

    -0.0054359     0.0026176             0      0.76042    0.00039657             0      0.013817    -0.00038425              0       0.45781    -0.0073502             0
     0.0013986    -0.0020541             0            0       0.88449             0    0.00019782       0.013511              0             0       0.45623             0
       0.00706     0.0030715             0    0.0072834    -0.0006405             1     -0.013863      -0.013564              0    -0.0079166      0.003065       0.45562

                  q_source_pos                            q_source_moment             q_sensor_pos    q_sensor_moment
    _________________________________________    _________________________________    ____________    _______________

      -0.022581       0.039612       0.029441     -2.749     0.086359      0.12607    0    0    0       0    0    0  
      0.0010878      -0.059203      0.0059278    0.10572     -0.17748     0.023411    0    0    0       0    0    0  
    -0.00099269       0.011834       -0.01772     0.5082    0.0018718      0.46384    0    0    0       0    0    0  

Source fix: [0.27815 0.01697 0.01761 0.02533 0.04934 -1.59915 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00857 -0.00705 1.55803 ]
    22       1242       0.0102899      0.0845679          0.274      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0058259     0.0027021             0      0.76017     0.00022013              0      0.013816    -0.00038413              0       0.45803    -0.0073539             0
     0.0014202    -0.0021241             0            0        0.88424              0    0.00019779        0.01351              0             0       0.45646             0
     0.0073124     0.0031322             0    0.0068945    -0.00062607              1     -0.013863      -0.013563              0    -0.0079197     0.0030679       0.45585

                  q_source_pos                            q_source_moment             q_sensor_pos    q_sensor_moment
    _________________________________________    _________________________________    ____________    _______________

      -0.021667       0.038269       0.029658    -2.8311     0.090185      0.12892    0    0    0       0    0    0  
      0.0010215      -0.058239      0.0057457    0.10408     -0.18993     0.023238    0    0    0       0    0    0  
    -0.00059339       0.011691      -0.017591    0.51908    0.0018384       0.4749    0    0    0       0    0    0  

Source fix: [0.27824 0.01702 0.01766 0.02528 0.04938 -1.59893 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00857 -0.00705 1.55803 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0058259     0.0027021             0      0.76017     0.00022013              0      0.013816    -0.00038413              0       0.45803    -0.0073539             0
     0.0014202    -0.0021241             0            0        0.88424              0    0.00019779        0.01351              0             0       0.45646             0
     0.0073124     0.0031322             0    0.0068945    -0.00062607              1     -0.013863      -0.013563              0    -0.0079197     0.0030679       0.45585

                  q_source_pos                            q_source_moment             q_sensor_pos    q_sensor_moment
    _________________________________________    _________________________________    ____________    _______________

      -0.021667       0.038269       0.029658    -2.8311     0.090185      0.12892    0    0    0       0    0    0  
      0.0010215      -0.058239      0.0057457    0.10408     -0.18993     0.023238    0    0    0       0    0    0  
    -0.00059339       0.011691      -0.017591    0.51908    0.0018384       0.4749    0    0    0       0    0    0  

Source fix: [0.27824 0.01702 0.01766 0.02528 0.04938 -1.59893 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00857 -0.00705 1.55803 ]
    23       1296       0.0102751      0.0845679          0.147      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0061967     0.0027974             0      0.75983     4.5382e-05              0      0.013815    -0.00038439              0       0.45828    -0.0073579             0
     0.0014392    -0.0022026             0            0        0.88397              0    0.00019773       0.013509              0             0       0.45671             0
     0.0075659     0.0031984             0    0.0064729    -0.00061024              1     -0.013861      -0.013562              0    -0.0079232      0.003071       0.45609

                  q_source_pos                            q_source_moment             q_sensor_pos    q_sensor_moment
    _________________________________________    _________________________________    ____________    _______________

      -0.020893       0.036846       0.029882    -2.9128     0.094426      0.13204    0    0    0       0    0    0  
     0.00095589      -0.057175      0.0055607    0.10236     -0.20429     0.023054    0    0    0       0    0    0  
    -0.00026947       0.011537      -0.017454    0.52855    0.0017925      0.48698    0    0    0       0    0    0  

Source fix: [0.27834 0.01707 0.01771 0.02523 0.04944 -1.59872 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00857 -0.00705 1.55803 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0061967     0.0027974             0      0.75983     4.5382e-05              0      0.013815    -0.00038439              0       0.45828    -0.0073579             0
     0.0014392    -0.0022026             0            0        0.88397              0    0.00019773       0.013509              0             0       0.45671             0
     0.0075659     0.0031984             0    0.0064729    -0.00061024              1     -0.013861      -0.013562              0    -0.0079232      0.003071       0.45609

                  q_source_pos                            q_source_moment             q_sensor_pos    q_sensor_moment
    _________________________________________    _________________________________    ____________    _______________

      -0.020893       0.036846       0.029882    -2.9128     0.094426      0.13204    0    0    0       0    0    0  
     0.00095589      -0.057175      0.0055607    0.10236     -0.20429     0.023054    0    0    0       0    0    0  
    -0.00026947       0.011537      -0.017454    0.52855    0.0017925      0.48698    0    0    0       0    0    0  

Source fix: [0.27834 0.01707 0.01771 0.02523 0.04944 -1.59872 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00857 -0.00705 1.55803 ]

    24       1350       0.0102689       0.169136           0.59      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0068511      0.003008             0      0.75895    -0.00032999              0      0.013814    -0.00038416              0       0.45885     -0.007367             0
     0.0014744    -0.0023962             0            0        0.88333              0    0.00019769       0.013509              0             0       0.45728             0
      0.008089     0.0033525             0    0.0054873    -0.00057256              1     -0.013859       -0.01356              0    -0.0079311     0.0030781       0.45667

                 q_source_pos                          q_source_moment              q_sensor_pos    q_sensor_moment
    ______________________________________    __________________________________    ____________    _______________

     -0.019557      0.033608      0.030373     -3.0743      0.10455      0.13942    0    0    0       0    0    0  
    0.00080905     -0.054642     0.0051575    0.098009     -0.24013     0.022633    0    0    0       0    0    0  
    0.00022393      0.011181     -0.017144     0.54359    0.0016607      0.51542    0    0    0       0    0    0  

Source fix: [0.27858 0.01718 0.01783 0.02510 0.04956 -1.59825 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00856 -0.00705 1.55803 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0068511      0.003008             0      0.75895    -0.00032999              0      0.013814    -0.00038416              0       0.45885     -0.007367             0
     0.0014744    -0.0023962             0            0        0.88333              0    0.00019769       0.013509              0             0       0.45728             0
      0.008089     0.0033525             0    0.0054873    -0.00057256              1     -0.013859       -0.01356              0    -0.0079311     0.0030781       0.45667

                 q_source_pos                          q_source_moment              q_sensor_pos    q_sensor_moment
    ______________________________________    __________________________________    ____________    _______________

     -0.019557      0.033608      0.030373     -3.0743      0.10455      0.13942    0    0    0       0    0    0  
    0.00080905     -0.054642     0.0051575    0.098009     -0.24013     0.022633    0    0    0       0    0    0  
    0.00022393      0.011181     -0.017144     0.54359    0.0016607      0.51542    0    0    0       0    0    0  

Source fix: [0.27858 0.01718 0.01783 0.02510 0.04956 -1.59825 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00856 -0.00705 1.55803 ]
    25       1404       0.0102506       0.042284            0.3      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0069184     0.0031085             0      0.75846    -0.00047926              0      0.013814    -0.00038388              0       0.45912    -0.0073713             0
     0.0014783    -0.0024978             0            0        0.88305              0    0.00019752       0.013508              0             0       0.45755             0
      0.008254      0.003425             0    0.0050248    -0.00055414              1     -0.013859       -0.01356              0    -0.0079349     0.0030815       0.45694

                 q_source_pos                          q_source_moment              q_sensor_pos    q_sensor_moment
    ______________________________________    __________________________________    ____________    _______________

     -0.019329      0.032141      0.030569     -3.1081      0.10968      0.14297    0    0    0       0    0    0  
     0.0007375     -0.053366     0.0049997    0.095259     -0.26036     0.022451    0    0    0       0    0    0  
    0.00020316      0.011011     -0.017009     0.54222    0.0015697      0.52896    0    0    0       0    0    0  

Source fix: [0.27870 0.01722 0.01789 0.02504 0.04961 -1.59805 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00856 -0.00705 1.55803 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0069184     0.0031085             0      0.75846    -0.00047926              0      0.013814    -0.00038388              0       0.45912    -0.0073713             0
     0.0014783    -0.0024978             0            0        0.88305              0    0.00019752       0.013508              0             0       0.45755             0
      0.008254      0.003425             0    0.0050248    -0.00055414              1     -0.013859       -0.01356              0    -0.0079349     0.0030815       0.45694

                 q_source_pos                          q_source_moment              q_sensor_pos    q_sensor_moment
    ______________________________________    __________________________________    ____________    _______________

     -0.019329      0.032141      0.030569     -3.1081      0.10968      0.14297    0    0    0       0    0    0  
     0.0007375     -0.053366     0.0049997    0.095259     -0.26036     0.022451    0    0    0       0    0    0  
    0.00020316      0.011011     -0.017009     0.54222    0.0015697      0.52896    0    0    0       0    0    0  

Source fix: [0.27870 0.01722 0.01789 0.02504 0.04961 -1.59805 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00856 -0.00705 1.55803 ]
    26       1458       0.0102375      0.0845679          0.324      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0068823     0.0033577             0      0.75719     -0.0008347              0      0.013812    -0.00038439              0       0.45979    -0.0073818             0
     0.0014801    -0.0027708             0            0        0.88234              0    0.00019712       0.013507              0             0       0.45821             0
     0.0086068     0.0036068             0    0.0038671    -0.00050759              1     -0.013856      -0.013558              0    -0.0079442     0.0030897       0.45761

                  q_source_pos                           q_source_moment            q_sensor_pos    q_sensor_moment
    _________________________________________    _______________________________    ____________    _______________

       -0.01896       0.028577       0.031025    -3.1586      0.1228     0.15194    0    0    0       0    0    0  
     0.00055165      -0.050111      0.0046327    0.08774    -0.31515    0.022017    0    0    0       0    0    0  
    -4.6508e-06       0.010587      -0.016679    0.53264    0.001308     0.56314    0    0    0       0    0    0  

Source fix: [0.27897 0.01734 0.01804 0.02489 0.04976 -1.59757 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00856 -0.00704 1.55803 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0068823     0.0033577             0      0.75719     -0.0008347              0      0.013812    -0.00038439              0       0.45979    -0.0073818             0
     0.0014801    -0.0027708             0            0        0.88234              0    0.00019712       0.013507              0             0       0.45821             0
     0.0086068     0.0036068             0    0.0038671    -0.00050759              1     -0.013856      -0.013558              0    -0.0079442     0.0030897       0.45761

                  q_source_pos                           q_source_moment            q_sensor_pos    q_sensor_moment
    _________________________________________    _______________________________    ____________    _______________

       -0.01896       0.028577       0.031025    -3.1586      0.1228     0.15194    0    0    0       0    0    0  
     0.00055165      -0.050111      0.0046327    0.08774    -0.31515    0.022017    0    0    0       0    0    0  
    -4.6508e-06       0.010587      -0.016679    0.53264    0.001308     0.56314    0    0    0       0    0    0  

Source fix: [0.27897 0.01734 0.01804 0.02489 0.04976 -1.59757 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00856 -0.00704 1.55803 ]
    27       1512       0.0102282      0.0845679          0.404      
                 d_source_pos                             d_source_moment                             d_sensor_pos                            d_sensor_moment            
    ______________________________________    _______________________________________    ______________________________________    ______________________________________

    -0.0065068     0.0036025             0      0.75592     -0.0011331              0      0.013811    -0.0003845             0       0.46043    -0.0073919             0
     0.0014682    -0.0030989             0            0         0.8817              0    0.00019667      0.013506             0             0       0.45885             0
     0.0088456     0.0037853             0    0.0027473    -0.00045954              1     -0.013855     -0.013556             0    -0.0079532     0.0030976       0.45825

                  q_source_pos                             q_source_moment               q_sensor_pos    q_sensor_moment
    _________________________________________    ____________________________________    ____________    _______________

      -0.018928        0.02512       0.031369     -3.1449       0.13729       0.16096    0    0    0       0    0    0  
     0.00035471      -0.046526      0.0043437    0.079393      -0.38577      0.021661    0    0    0       0    0    0  
    -0.00048389       0.010134      -0.016377     0.51227    0.00095395       0.59734    0    0    0       0    0    0  

Source fix: [0.27925 0.01744 0.01818 0.02474 0.04989 -1.59712 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00856 -0.00704 1.55803 ]
                 d_source_pos                             d_source_moment                             d_sensor_pos                            d_sensor_moment            
    ______________________________________    _______________________________________    ______________________________________    ______________________________________

    -0.0065068     0.0036025             0      0.75592     -0.0011331              0      0.013811    -0.0003845             0       0.46043    -0.0073919             0
     0.0014682    -0.0030989             0            0         0.8817              0    0.00019667      0.013506             0             0       0.45885             0
     0.0088456     0.0037853             0    0.0027473    -0.00045954              1     -0.013855     -0.013556             0    -0.0079532     0.0030976       0.45825

                  q_source_pos                             q_source_moment               q_sensor_pos    q_sensor_moment
    _________________________________________    ____________________________________    ____________    _______________

      -0.018928        0.02512       0.031369     -3.1449       0.13729       0.16096    0    0    0       0    0    0  
     0.00035471      -0.046526      0.0043437    0.079393      -0.38577      0.021661    0    0    0       0    0    0  
    -0.00048389       0.010134      -0.016377     0.51227    0.00095395       0.59734    0    0    0       0    0    0  

Source fix: [0.27925 0.01744 0.01818 0.02474 0.04989 -1.59712 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00856 -0.00704 1.55803 ]
    28       1566       0.0102191      0.0845679          0.355      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0061531     0.0037738             0      0.75503     -0.0012988              0       0.01381    -0.00038478              0       0.46087    -0.0073988             0
     0.0014584    -0.0034244             0            0        0.88131              0    0.00019662       0.013506              0             0        0.4593             0
     0.0089903     0.0039133             0    0.0019627    -0.00042266              1     -0.013854      -0.013555              0    -0.0079594     0.0031029       0.45869

                  q_source_pos                             q_source_moment               q_sensor_pos    q_sensor_moment
    _________________________________________    ____________________________________    ____________    _______________

      -0.018982        0.02254       0.031542     -3.1194       0.14956        0.1676    0    0    0       0    0    0  
     0.00020835      -0.043464      0.0041777    0.073448      -0.45872      0.021462    0    0    0       0    0    0  
    -0.00090837      0.0097505      -0.016172       0.495    0.00062679       0.62251    0    0    0       0    0    0  

Source fix: [0.27944 0.01752 0.01829 0.02464 0.04999 -1.59681 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00855 -0.00704 1.55804 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0061531     0.0037738             0      0.75503     -0.0012988              0       0.01381    -0.00038478              0       0.46087    -0.0073988             0
     0.0014584    -0.0034244             0            0        0.88131              0    0.00019662       0.013506              0             0        0.4593             0
     0.0089903     0.0039133             0    0.0019627    -0.00042266              1     -0.013854      -0.013555              0    -0.0079594     0.0031029       0.45869

                  q_source_pos                             q_source_moment               q_sensor_pos    q_sensor_moment
    _________________________________________    ____________________________________    ____________    _______________

      -0.018982        0.02254       0.031542     -3.1194       0.14956        0.1676    0    0    0       0    0    0  
     0.00020835      -0.043464      0.0041777    0.073448      -0.45872      0.021462    0    0    0       0    0    0  
    -0.00090837      0.0097505      -0.016172       0.495    0.00062679       0.62251    0    0    0       0    0    0  

Source fix: [0.27944 0.01752 0.01829 0.02464 0.04999 -1.59681 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00855 -0.00704 1.55804 ]
    29       1620       0.0102079      0.0845679          0.288      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0058797     0.0038973             0      0.75439     -0.0013869              0       0.01381    -0.00038453              0       0.46119    -0.0074037             0
     0.0014531    -0.0037623             0            0        0.88106              0    0.00019655       0.013505              0             0       0.45962             0
      0.009095     0.0040109             0    0.0013892    -0.00039531              1     -0.013853      -0.013555              0    -0.0079639     0.0031066       0.45902

                 q_source_pos                           q_source_moment               q_sensor_pos    q_sensor_moment
    ______________________________________    ____________________________________    ____________    _______________

     -0.019036      0.020519      0.031625      -3.098       0.16016        0.1727    0    0    0       0    0    0  
    9.7749e-05     -0.040781     0.0040707    0.069214        -0.536      0.021354    0    0    0       0    0    0  
     -0.001246     0.0094181     -0.016019      0.4817    0.00044135       0.64192    0    0    0       0    0    0  

Source fix: [0.27958 0.01758 0.01837 0.02456 0.05006 -1.59658 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00855 -0.00704 1.55804 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0058797     0.0038973             0      0.75439     -0.0013869              0       0.01381    -0.00038453              0       0.46119    -0.0074037             0
     0.0014531    -0.0037623             0            0        0.88106              0    0.00019655       0.013505              0             0       0.45962             0
      0.009095     0.0040109             0    0.0013892    -0.00039531              1     -0.013853      -0.013555              0    -0.0079639     0.0031066       0.45902

                 q_source_pos                           q_source_moment               q_sensor_pos    q_sensor_moment
    ______________________________________    ____________________________________    ____________    _______________

     -0.019036      0.020519      0.031625      -3.098       0.16016        0.1727    0    0    0       0    0    0  
    9.7749e-05     -0.040781     0.0040707    0.069214        -0.536      0.021354    0    0    0       0    0    0  
     -0.001246     0.0094181     -0.016019      0.4817    0.00044135       0.64192    0    0    0       0    0    0  

Source fix: [0.27958 0.01758 0.01837 0.02456 0.05006 -1.59658 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00855 -0.00704 1.55804 ]
    30       1674       0.0101995       0.049093         0.0709      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0057322     0.0039382             0      0.75417      -0.001405              0      0.013809    -0.00038435              0        0.4613    -0.0074053             0
     0.0014507    -0.0039579             0            0        0.88099              0    0.00019666       0.013505              0             0       0.45972             0
     0.0091178     0.0040511             0    0.0011842    -0.00038963              1     -0.013853      -0.013554              0    -0.0079653     0.0031078       0.45912

                 q_source_pos                           q_source_moment               q_sensor_pos    q_sensor_moment
    ______________________________________    ____________________________________    ____________    _______________

     -0.019105      0.019715      0.031628     -3.0813       0.16484       0.17466    0    0    0       0    0    0  
    5.0737e-05     -0.039561     0.0040373    0.067532      -0.58072      0.021341    0    0    0       0    0    0  
    -0.0014245     0.0092708     -0.015959     0.47509    0.00071778       0.64939    0    0    0       0    0    0  

Source fix: [0.27964 0.01760 0.01840 0.02454 0.05009 -1.59651 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00855 -0.00704 1.55804 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0057322     0.0039382             0      0.75417      -0.001405              0      0.013809    -0.00038435              0        0.4613    -0.0074053             0
     0.0014507    -0.0039579             0            0        0.88099              0    0.00019666       0.013505              0             0       0.45972             0
     0.0091178     0.0040511             0    0.0011842    -0.00038963              1     -0.013853      -0.013554              0    -0.0079653     0.0031078       0.45912

                 q_source_pos                           q_source_moment               q_sensor_pos    q_sensor_moment
    ______________________________________    ____________________________________    ____________    _______________

     -0.019105      0.019715      0.031628     -3.0813       0.16484       0.17466    0    0    0       0    0    0  
    5.0737e-05     -0.039561     0.0040373    0.067532      -0.58072      0.021341    0    0    0       0    0    0  
    -0.0014245     0.0092708     -0.015959     0.47509    0.00071778       0.64939    0    0    0       0    0    0  

Source fix: [0.27964 0.01760 0.01840 0.02454 0.05009 -1.59651 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00855 -0.00704 1.55804 ]
    31       1728        0.010199     0.00475798        0.00083      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0057414     0.0039415             0      0.75417     -0.0014229              0      0.013809    -0.00038436              0        0.4613    -0.0074053             0
     0.0014515    -0.0039422             0            0        0.88096              0    0.00019666       0.013505              0             0       0.45973             0
     0.0091226     0.0040578             0    0.0011792    -0.00039643              1     -0.013853      -0.013554              0    -0.0079653     0.0031078       0.45913

                 q_source_pos                          q_source_moment              q_sensor_pos    q_sensor_moment
    ______________________________________    __________________________________    ____________    _______________

     -0.019092      0.019902      0.031624     -3.0831      0.16419      0.17474    0    0    0       0    0    0  
    5.0312e-05     -0.039755     0.0040361    0.067546     -0.57639     0.021344    0    0    0       0    0    0  
    -0.0014155     0.0093141     -0.015955     0.47534    0.0011405      0.64966    0    0    0       0    0    0  

Source fix: [0.27964 0.01760 0.01840 0.02454 0.05009 -1.59650 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00855 -0.00704 1.55804 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0057414     0.0039415             0      0.75417     -0.0014229              0      0.013809    -0.00038436              0        0.4613    -0.0074053             0
     0.0014515    -0.0039422             0            0        0.88096              0    0.00019666       0.013505              0             0       0.45973             0
     0.0091226     0.0040578             0    0.0011792    -0.00039643              1     -0.013853      -0.013554              0    -0.0079653     0.0031078       0.45913

                 q_source_pos                          q_source_moment              q_sensor_pos    q_sensor_moment
    ______________________________________    __________________________________    ____________    _______________

     -0.019092      0.019902      0.031624     -3.0831      0.16419      0.17474    0    0    0       0    0    0  
    5.0312e-05     -0.039755     0.0040361    0.067546     -0.57639     0.021344    0    0    0       0    0    0  
    -0.0014155     0.0093141     -0.015955     0.47534    0.0011405      0.64966    0    0    0       0    0    0  

Source fix: [0.27964 0.01760 0.01840 0.02454 0.05009 -1.59650 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00855 -0.00704 1.55804 ]
    32       1782        0.010199     0.00954313        0.00166      
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0057893      0.003941             0      0.75418     -0.0014229              0      0.013809    -0.00038436              0        0.4613    -0.0074053             0
     0.0014537     -0.003928             0            0        0.88095              0    0.00019665       0.013505              0             0       0.45973             0
     0.0091378     0.0040576             0    0.0011875    -0.00039658              1     -0.013853      -0.013554              0    -0.0079653     0.0031078       0.45913

                 q_source_pos                         q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    ________________________________    ____________    _______________

      -0.01904          0.02      0.031624     -3.0917     0.16369     0.17474    0    0    0       0    0    0  
    5.8061e-05     -0.039867      0.004036    0.067844    -0.57296    0.021343    0    0    0       0    0    0  
    -0.0013582     0.0093377     -0.015955     0.47724    0.001119     0.64964    0    0    0       0    0    0  

Source fix: [0.27964 0.01760 0.01840 0.02454 0.05009 -1.59651 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00855 -0.00704 1.55804 ]
                 d_source_pos                             d_source_moment                              d_sensor_pos                             d_sensor_moment            
    ______________________________________    _______________________________________    ________________________________________    ______________________________________

    -0.0057893      0.003941             0      0.75418     -0.0014229              0      0.013809    -0.00038436              0        0.4613    -0.0074053             0
     0.0014537     -0.003928             0            0        0.88095              0    0.00019665       0.013505              0             0       0.45973             0
     0.0091378     0.0040576             0    0.0011875    -0.00039658              1     -0.013853      -0.013554              0    -0.0079653     0.0031078       0.45913

                 q_source_pos                         q_source_moment             q_sensor_pos    q_sensor_moment
    ______________________________________    ________________________________    ____________    _______________

      -0.01904          0.02      0.031624     -3.0917     0.16369     0.17474    0    0    0       0    0    0  
    5.8061e-05     -0.039867      0.004036    0.067844    -0.57296    0.021343    0    0    0       0    0    0  
    -0.0013582     0.0093377     -0.015955     0.47724    0.001119     0.64964    0    0    0       0    0    0  

Source fix: [0.27964 0.01760 0.01840 0.02454 0.05009 -1.59651 ]
Sensor fix: [0.00008 0.00001 0.01366 0.00855 -0.00704 1.55804 ]

Optimization stopped because the relative sum of squares (r) is changing
by less than options.FunctionTolerance = 1.000000e-08.

Optimization Metric                                  Options
relative change r =   2.39e-10             FunctionTolerance =   1e-08 (selected)


cal_residue =

     0.010199

>> check_poses

data_file =

  1×3 cell array

    {'Z_rot_md.dat'}    {'X_rot_md.dat'}    {'Y_rot_md.dat'}


cal_file =

    'so_quadrupole_all_hr_cal.mat'


Local minimum found.

Optimization completed because the size of the gradient is less than
the selected value of the optimality tolerance.

<stopping criteria details>


source_fix_delta =

   2.2173e-05  -2.3391e-05   2.3427e-05  -0.00027248   2.3054e-05   0.00038264


sensor_fix_delta =

  -1.3913e-05  -2.8525e-05   8.0935e-06   0.00079409   3.4519e-05  -0.00029946

Position error (m): 3.89e-04 RMS, 1.14e-03 max.
Orientation error (radians): 4.51e-03 RMS, 8.06e-03 max

trans_err_rms =

   0.00014895   0.00021533   0.00028725


rot_err_rms =

    0.0035583    0.0022521    0.0016126

>> check_poses

data_file =

  1×3 cell array

    {'Z_rot_ld.dat'}    {'X_rot_ld.dat'}    {'Y_rot_ld.dat'}


cal_file =

    'so_quadrupole_all_hr_cal.mat'


Local minimum possible.

lsqnonlin stopped because the final change in the sum of squares relative to 
its initial value is less than the selected value of the function tolerance.

<stopping criteria details>


source_fix_delta =

  -2.2122e-05  -8.5111e-05   6.5347e-05    0.0010534   0.00088409   0.00048733


sensor_fix_delta =

  -2.4131e-05   3.7302e-06  -1.4635e-05   0.00057019  -2.8876e-05   -0.0012298

Position error (m): 3.44e-04 RMS, 1.09e-03 max.
Orientation error (radians): 3.67e-03 RMS, 6.69e-03 max

trans_err_rms =

   0.00013137   0.00018341   0.00025958


rot_err_rms =

    0.0025425     0.002018    0.0017047


[13 May 21]

The CMU concentric coil seems to work pretty well, based on Rz only calibration and testing.

With cal_5_12_premo_cmu, the CMU coil and Premo sensor, I get:
________________________________________________________________

>> calibrate_main

cal_mode = 'Z_only'
sensor = 'premo'
in_files = 'Z_rot_sd.dat'

freeze =    {'d_so_y_co'}    {'d_se_y_co'}    {'z_se_fix'}

C:\Users\robma\Documents\Work\ilemt\cal_data\cal_5_12_premo_cmu

                  d_source_pos                             d_source_moment                             d_sensor_pos                              d_sensor_moment           
    ________________________________________    _____________________________________    _________________________________________    _____________________________________

    -0.0028945    -0.00011047              0      0.82607     0.0015808             0    -0.00012876    -0.00031151              0      0.39349    0.00086347             0
    0.00015078     -0.0012705              0            0      -0.90029             0     5.7612e-05      6.366e-05              0            0       0.39122             0
     0.0012655      0.0012935              0    0.0013535    0.00057268             1    -4.2505e-05     2.2434e-05              0    0.0056013     0.0048971      -0.40279

Source fix: [0.23508 0.02007 0.01656 0.00500 0.02437 -1.57890 ]
Sensor fix: [-0.00017 0.00059 -0.00011 -2.20387 -2.22663 0.00019 ]

>> check_poses

data_file = 'Z_rot_md.dat'
cal_file = 'Z_only_hr_cal.mat'

Not doing optimization.
Position error (m): 3.94e-04 RMS, 8.14e-04 max.
Orientation error (radians): 1.05e+00 RMS, 6.28e+00 max

trans_err_rms =
   0.00014352    0.0002828    0.0002331

rot_err_rms =
      0.74538      0.74462     0.008243
________________________________________________________________

This is a better than the best corner-dipole/dipole results, especially on max
error, and RMS is quite significantly better that corner-dipole/premo.  For
some reason the check_poses fixture optimization flaked out, perhaps related
to the sensor fixture rotation being near pi?

Source axis orthogonality is ~20x better than the corner-dipole source, which
is probably related to less cross-coupling.  As I think I noted before, the
off-axis compensation converges much faster with the CMU-concentric source
than with the corner-dipole.  The concentricity according to the d_source_pos
(~2mm) is also pretty good, considering the core is made from glued E-cores
(with holes) rather than an actual cube, and is also hand-wound.


What to do next?
 -- it seems likely that the combo of CMU-concentric source with the dipole
    sensor will give the best accuracy yet.  So we want a good amount of data
    in that setup. 
 -- worth trying whether the sensor quadrupole helps the Premo sensor, and how
    much the source quadrupole helps the CMU-concentric.  To look at
    quadrupole, we want the XYZ data, preferably medium size. 
 -- Revisit coupling bias correction, look at pose sensitivity to coupling.


What are we trying to achieve here?
 -- Low error, over full pose space (not currently tested)
 -- Insight into error mechanisms.  What is the effectiveness of the dipole
    coil?  When is cross-coupling a problem?
 -- A practical near-term source/sensor configuration
 -- Everything else: a usable real-time system, publications and documentation

Considering "everything else", one of our criteria is when to stop trying to
improve accuracy.  But it does make sense to concentrate on one thing at a
time.

Research needs feed back into experiments, but at least initially I can
concentrate on getting the best accuracy.  For maybe 2 weeks?  One research
test that could feed back into accuracy work is the coupling sensitivity.


General comments on calibration/test data:
 -- At least for dipole calibration, there is not a whole lot of difference in
    accuracy with medium vs. small data, and with three fixtures vs. one.
 -- Error is worse with three fixtures (which makes sense), and IIRC
    calibrating with three fixtures helps the three fixture test results
    (which also makes sense).
 -- Three fixture medium data does seem to make the source quadrupole term
    more observable.


It tentatively seems that the quadrupole is more beneficial for the cube
coils, at least so far as calibration residual goes. (Which is what we would
expect.)  But the results are still physically unreasonable for axis asymmetry
and quadrupole location, and this is likely due to under-constraint /
insufficient data.  Might be worth a try to constrain the quadrupole to the
same location as the dipole.  This would regularize the solution into a form
that is more likely to generalize to other source configurations.  A distant
location for the quadrupole could also suggest magnetic interference.


Other interpretation:
 -- That the bias estimate from mean residue did not help kind of proves that
    other errors are dominant, probably way dominant.  Because it *would* have
    worked if bias had been dominant.
 -- If the level of magnetic interference we are seeing in the test setup is a
    problem, then it's rather hopeless to get better accuracy in any realistic
    setting.  My feel from the 1DOF measurement is that even if we multiply
    10x to get 3DOF position error, we are not going to break 200um, and 100um
    or less seems likely.


I tried sensor quadrupole with the corner-dipole/premo, and it reduced the
residue a fair amount, but made error about 2x worse, tested on the exact same
calibration data.
________________________________________________________________
>> calibrate_main

cal_mode = 'se_quadrupole_all'
sensor = 'premo'
base_calibration = 'se_quadrupole_hr_cal'

optimize =
    {'q_se_pos'}    {'q_se_mo'}    {'d_so_pos'}    {'d_so_mo'}    {'d_se_pos'}    {'d_se_mo'}    {'so_fix'}
    {'se_fix'}

C:\Users\robma\Documents\Work\ilemt\cal_data\cal_5_12_premo

                 d_source_pos                            d_source_moment                            d_sensor_pos                               d_sensor_moment            
    _______________________________________    ___________________________________    _________________________________________    _______________________________________

     0.046059    -0.00097317              0      0.93065    0.0027972            0     0.00034788     0.00015744              0      0.15873    -3.1629e-05              0
    0.0023127       0.046151              0            0       0.9465            0    -0.00022111    -3.9673e-05              0            0        0.15817              0
    -0.044711      -0.042794              0    -0.025737     0.011003            1    -0.00049703    -0.00034355              0    0.0025223      0.0015475       -0.16168

    q_source_pos    q_source_moment                q_sensor_pos                            q_sensor_moment            
    ____________    _______________    _____________________________________    ______________________________________

    0    0    0       0    0    0      -0.042981      0.030592    -0.0062105     -0.019118      -0.17397      0.066714
    0    0    0       0    0    0      -0.015958     -0.035286     -0.014011    -0.0086062     -0.091542      -0.02458
    0    0    0       0    0    0      -0.011211      0.083887      0.022254       0.03386      0.063594      -0.28419

Source fix: [0.24990 0.02790 -0.03741 0.01394 0.01790 -1.56198 ]
Sensor fix: [-0.00002 0.00007 -0.00059 -2.20160 -2.23248 -0.00116 ]


>> check_poses

data_file =
    {'Z_rot_sd.dat'}    {'X_rot_sd.dat'}    {'Y_rot_sd.dat'}

cal_file =
    'se_quadrupole_all_hr_cal.mat'

Not doing optimization.
Position error (m): 6.59e-04 RMS, 2.25e-03 max.
Orientation error (radians): 7.99e-03 RMS, 3.47e-02 max

trans_err_rms =
   0.00017457   0.00041487   0.00048074

rot_err_rms =
    0.0038418    0.0048087    0.0050908

>> sum(sum(sum(norm_residue.^2)))

ans =

    0.0024784
________________________________________________________________

It bears some thought how we can be reducing the residue yet increasing the
position error when run on the training data.  Of course if we were
overfitting then we would expect this when run on *other* data.

So it seems that to a *significant* degree, under some conditions, minimizing
the residue is not resulting in reduced pose error.  That is, the goal we are
giving optimization is not really correct.  We've considered this general
possibility, and this is the reason for the normalization in the objective
function, but...

The thing is, the pose solution is minimizing the exact same residue, but on
only a single point.  So when we optimize the calibration ensemble, we must
not be correctly weighting the points.
 ==> One idea is that we could emperically weight the data, based on observed
     errors.  This could capture e.g. error increase at the edges of the
     workspace.
 ==> Normalizing by the norm of the coupling is not aggressive enough to
     minimize error across range variation, since (I assume, like noise) error
     goes as r^4, while field strength as r^3.

 ==> Given a certain level of model error, it's a somewhat arbitrary decision
     which points to give high error, and which low.  Traditionally you try to
     equalize, which tends to minimize max error, while also working OK on
     RMS.  But given the intrinsic tendency of error to increase with range,
     perhaps it makes more sense to just allow that?

What sort of error specification you consider acceptable comes in here.
Trying to force the error to act unnaturally may increase the risk of
overfitting to the particular test data.  But this only actually applies if we
were weighting the pose error, which we are not.



Thoughts on sensitivity:

Some exploratory probes suggest that the sensitivity is about what you would
expect, or perhaps 2-3x less.  eg. a 1% scaling causes less than 1% distance
error.  In the home pose (r = 250mm), 1% scaling or 10 mrad rotation cause
about 1mm error.  For the radial translation error, we expect below linear,
since the radial distance is a cube root.  1.01^(1/3) = 1.0033

A rotation of the coupling roughly corresponds to a rotation of the measured
field, such as is caused by magnetic interference or model error.  For a
concentric symmetric sensor this is a pretty close correspondence.


To look at this systematically:
 -- Test across the workspace
 -- Try several different perturbations, eg. scaling or rotation of row or
    column of coupling
 -- Look at radial and tangential position, angular, and moment.  Summary
    statistics across these.


A somewhat different thing to consider is sensitivity to perturbations in the
calibration.




[12 May 21]


I reworked forward_kinematics.m, without changing what it computes.  It is
clearer now, and also significantly faster.  I am now pretty sure it is doing
what I think it should be doing.  I have not gone over fk_coupling, the dipole
part, but that has gotten a lot of attention in the past, and seems to be
working (based on the fairly good dipole model fit).


Got new data for the dipole and premo sensors.  I re-zeroed the Rz XY offset
on the stage before taking the dipole data.  It was not too far out, something
like 100 um.  But this is not very stable, and the instability is probably
partly in alignment of the calibration fixture.  I am not at all confident in
the fixturing at the 100um level.

The premo data is not cooperating, must be inconsistent kinematics or initial
state is too far off.  But coupling at zero pose looks weird, big Y value is
not on the diagonal.


The dipole data is "medium" size, and is working, without the X sign flip (now
cancelled in ilemt_ui).

cal_data/cal_11_5/XYZ_hr_cal, residual 6.4e-3
________________________________________________________________

                 d_source_pos                            d_source_moment                            d_sensor_pos                             d_sensor_moment            
    _______________________________________    ___________________________________    ________________________________________    ______________________________________

     0.046059    -0.00096892              0       0.9116    0.0023166            0      0.013832    -0.00037614              0       0.18034    -0.0028503             0
    0.0023164       0.046113              0            0       0.9356            0    0.00018629       0.013539              0             0       0.17968             0
    -0.044225      -0.042902              0    -0.033719      0.01138            1     -0.013867      -0.013598              0    -0.0029648     0.0012663       0.17953

Source fix: [0.24994 0.02792 -0.03705 0.01345 0.01752 -1.56213 ]
Sensor fix: [0.00009 0.00003 0.01366 0.00751 -0.00652 1.55689 ]

>> check_poses

data_file = 'Z_rot_ld.dat'
cal_file = 'XYZ_hr_cal.mat'

source_fix_delta =
  -4.2209e-05  -9.0034e-05  -7.7893e-05   0.00088732   -0.0011039    0.0023495

sensor_fix_delta =
  -6.9268e-05   0.00012095   0.00044659    0.0026587   0.00032639    -0.003711

Position error (m): 4.59e-04 RMS, 1.55e-03 max.
Orientation error (radians): 4.06e-03 RMS, 1.21e-02 max

trans_err_rms =
   0.00017733    0.0002855   0.00031333

rot_err_rms =
    0.0015718    0.0020301    0.0031463
________________________________________________________________

Using the medium data for calibration does not seem to have improved the
performance on the Rz only test data.  It is somewhat worse, though that may
be meaningless.  And no sign that my fiddling with accurate fixturing made a
difference either (which likely means other errors dominate).  The increase in
calibration residual is expected because there is about 2x more data.


cal_5_11/all_hr_cal, residual 5.9e-3
________________________________________________________________

               d_source_pos                             d_source_moment                              d_sensor_pos                            d_sensor_moment          
    _____________________________________    _______________________________________    ________________________________________    ___________________________________

     0.045131    -0.0021892             0      0.90181    -0.00058719              0      0.013826    -0.00036938              0      0.18068    -0.002861            0
    0.0022953      0.045289             0            0        0.94315              0    0.00018607       0.013525              0            0      0.18003            0
    -0.043106     -0.042973             0    -0.032261       0.012017              1      -0.01384      -0.013568              0    -0.002962    0.0012792      0.17989

                 q_source_pos                           q_source_moment               q_sensor_pos    q_sensor_moment
    ______________________________________    ____________________________________    ____________    _______________

      0.030633      0.038236      0.052042    -0.61268    -0.0047262    -0.0046114    0    0    0       0    0    0  
    -0.0065335     0.0082803      0.031533    -0.10651      -0.12423     -0.020706    0    0    0       0    0    0  
      -0.05575      -0.04118      -0.11768     0.13535     0.0050364     0.0077363    0    0    0       0    0    0  

Source fix: [0.25015 0.02862 -0.03684 0.01467 0.01668 -1.55913 ]
Sensor fix: [0.00009 0.00003 0.01364 0.00753 -0.00654 1.55686 ]


>> check_poses

data_file = 'Z_rot_ld.dat'
cal_file = 'all_hr_cal.mat'

source_fix_delta =
  -7.3387e-05  -0.00012045  -8.7217e-05   0.00068599  -0.00047161    0.0015142

sensor_fix_delta =
  -7.4012e-05    0.0001552   0.00043344    0.0026771   0.00014869   -0.0030038

Position error (m): 4.36e-04 RMS, 1.44e-03 max.
Orientation error (radians): 3.75e-03 RMS, 1.20e-02 max

trans_err_rms =
   0.00016714    0.0002468    0.0003184


rot_err_rms =
    0.0012487    0.0019432    0.0029527

________________________________________________________________

So, with source quadrupole, with medium data, we are seeing about the same as
with the small data, but somewhat worse RMS error.  BTW, having the
'quadrupole' mode optimize 'd_so_mo', but not 'd_so_pos', or any sensor
parameters, worked quite well for getting started.  I had to add a hack to
calibrate_main to initialize the source quadrupole to non-zero due to the
zero/near-zero feature in forward_kinematics now actually working.

The XY quadrupole parameters are somewhat similar to what we got on [4 May 21]
using cal_5_3 small data, but Z is completely different.  XY also hold to the
pattern that moment is roughly diagonal, opposite in sign to the dipole, and
somewhat nearish to the dipole location.  I can't see any explanation for why
the axes would be so dissimilar except for the very asymmetric test data.
Only on X do we see both sides of the axis, and so are able to see whether the
field is axisymmetric or not.  Probably the dropping moments across YZ are due
to less support from the data.  In this run, there is really nothing from the
Z quadrupole.  Not only is the moment small, the position has run away to a
silly degree.


Is there a testing procedure for identifying the coupling signs and sensor
sign flips?  It's hard to get this right, especially when there is any
possible confusion about the sensor fixture.

 -- First, make sure the axis assignment is right, which (if the source axis
    assigment is right) we can do by checking for the strong couplings on the
    diagonal.

We need to drive the strong coupling off the diagonal to disambiguate

If flips and signs are correct, then:
 -- If you align each sensor axis the same way wrt. a single source axis, then
    the signs will all be the same, eg. + for aligned out the source axis.
 -- If you repeat this on the other source axes, then the signs will all be +
    also. 


I got the Premo sensor working, though there is a sign flip on the Z moment.
________________________________________________________________
>> calibrate_main

cal_mode = 'XYZ'
sensor = 'premo'
base_calibration = 'Z_only_hr_cal'

D:\ilemt\cal_data\cal_5_12_premo

                d_source_pos                          d_source_moment                            d_sensor_pos                              d_sensor_moment           
    _____________________________________    __________________________________    _________________________________________    _____________________________________

     0.045963    -0.0011718             0     0.93181    0.0015271            0     0.00018147     0.00015695              0      0.15856    0.00011797             0
    0.0024399       0.04613             0           0      0.94817            0     6.7801e-05     0.00011691              0            0        0.1579             0
    -0.044607     -0.042704             0    -0.02722     0.011294            1    -0.00013145     -2.515e-05              0    0.0020626     0.0017512      -0.16185

Source fix: [0.24982 0.02828 -0.03736 0.01360 0.01848 -1.56050 ]
Sensor fix: [-0.00023 0.00014 -0.00011 -2.20229 -2.23307 0.00189 ]

>> check_poses

data_file = {'Z_rot_sd.dat'}    {'X_rot_sd.dat'}    {'Y_rot_sd.dat'}
cal_file = 'XYZ_hr_cal.mat'

source_fix_delta =
   9.1768e-05  -5.0925e-05   0.00013758   -0.0013059   -0.0013746    0.0017815

sensor_fix_delta =
  -7.4656e-05  -0.00012261   4.0865e-05   -0.0012663    0.0031979    -0.001031

Position error (m): 5.65e-04 RMS, 1.45e-03 max.
Orientation error (radians): 7.40e-03 RMS, 1.92e-02 max

trans_err_rms =
   0.00019547   0.00034563   0.00040232

rot_err_rms =
    0.0039798    0.0042419    0.0045678

>> check_poses
data_file = 'Z_rot_sd.dat'
cal_file = 'XYZ_hr_cal.mat'

source_fix_delta =
   1.7233e-05  -3.3147e-05    0.0001601  -0.00072513  -0.00082492    0.0027424

sensor_fix_delta =
   3.9896e-05   1.9547e-05   6.1865e-05   -0.0031723    0.0051423   0.00031039

Position error (m): 5.11e-04 RMS, 1.23e-03 max.
Orientation error (radians): 7.07e-03 RMS, 1.87e-02 max

trans_err_rms =
    0.0001923   0.00029532    0.0003704

rot_err_rms =
    0.0024773    0.0044266    0.0049271
________________________________________________________________

Error is somewhat worse RMS than what we are getting with the dipole sensor, but
the sensor calibration is extremely "pretty": good symmetry, orthogonality and
alignment.
 ==> This suggests that source error may dominate. Possibly worse dipole
     conformance is having an effect, need to try quadrupole.  *sensor*
     quadrupole? 

But that it does work is basically good news because it means we can get
reasonable results with a commerical sensor.



[11 May 21]

Seems we need more generality than is in the current ilemt_ui phase
calibration, to deal with different sensor fixtures, perhaps input sign
flips or even XYZ permutations.

How did we get where we are?  We needed a coupling matrix with the correct
signs.  This requires us to know what phase to expect.  The phase varies
strongly by carrier frequency, due to non-flat frequency response in both
source and input side, and also digital latency on both ends.  But the net
effect is a phase which can be attributed to the source axis (and its
associated carrier frequency).

While we can attribute all of the phase variation to the source axis, the
sensor does actually contribute (via inductance variation), so the phase
calibration is dependent at least on the sensor type.  [If there is
significant mismatch between the sensor coils, then the frequency response
would change also, though perhaps not enough to cause significant sign errors.
To be really thorough, we would need to test the sign of each 3x3 coupling.]

This requires a phase calibration, which has to take place in a pose where we
know the sign of the strong couplings.  Simplest to make this be a particular
"standard" pose, so the signs are fixed.  So far, we assume that:
 1] Phase is measured from couplings on the diagonal (which should be strong),
 2] The couplings have particular signs: +--.

The +-- signs correspond to source and sensor axes aligned, but the sensor
translated out the X axis.  Once the phase has been calibrated it should be
valid in any sensor pose, and should also be quite stable over time, at least
to the accuracy necessary for sign determination.

Where do we want to get to?  The phase calibration should be part of the
complete system calibration (as should the output frequency response).
Currently these exist only in Labview, but the signal processing is going to
move out of labview into C++.  If these calibrations are done in labview, then
the data needs to be exported out of labview.  Currently they come out of
labview through their affect on the saved coupling data.

Because of the phase correction, it doesn't matter if there are sign flips on
the output side.  But sign flips in the input *do* cause problems because it
violates the assumption (in phase correction) that the input channels are
interchangeable.

Suppose we want to be able to work around flipped input signs (which have been
a problem).  The obvious fix is to invert the input signal, and this would
work.  But the inversion only matters insofar as it affects the sign
determination, so this could also be done during phase correction.


[10 May 21]

I took data with the Premo coil, and also got the midsize data with the dipole
coil.

The Premo data seems kind of tangled up wrt signs, fixture orientations, and
the interaction with the Labview phase correction.  At a minimum, the sensor
fixture has a Rz rotation so that X and Y interchange (by observation), and also almost
certainly has Z upside-down (because the package is mounted upside down).
Moving to pose:
    [22, 0, 0, 0, 0, 90]

gives a roughly diagonal coupling matrix with sensible magnitudes, but phase
calibration is probably not forcing the correct signs, since it forces the +--
signs that we get from our previous standard orientation (source and sensor
axes aligned, sensor is placed out along the X axis).

Then there is also the mysterious X input sign flip we were seeing with the
dipole coils, which is unexplained.

I tried getting calibration to figure out sensor fixture and moment
parameters, but it wasn't really working.

Looking at the Premo data in the above pose, relative to the reference levels
for the dipole sensor, all the signs are flipped.  IIRC this is not possible
for a rotation, so some other sign has flipped, perhaps the X has come
unflipped. Say, we rotate 180 degrees about X, then flip the X sign.  And if X
is non-flipped, then we need a positive X source moment again, so not
surprising that calibration was having trouble.

Looked at the actual sensor coil, and the axis directions are as you would
expect based on the label text orientation.  And also, in the fixturing I
chose, the fixture transform is an 180 degree rotation about X.  So that makes
sense together with X getting unflipped.  But reference phase correction is
not going to work without modification.  If we rotate to the +90 Rz then the
strong couplings are on the diagonal, as expected by phase_correct_coupling,
but the signs should then be +++.

Perhaps it would be prettier to rotate the sensor post +90 degrees Rz so that
at least the X for source and sensor are aligned in the stage home position.
But the sensor fixture has to be different from with the dipole sensor because
Z is down.



I collected a bias data point 'bias.dat' with shorted input.  The magnitudes
are much lower than what we were estimating, magnitude for elements is around
2e-6, with norm of the matrix 8e-6.  This is of course just a restatement of
my earlier observation using ilemt_ui that the input shorted reading is around
-100 to -120 dB.  This is small, but is probably a noticeable source of error
at longer ranges where the coupling can be down at 1e-3 or so.


 ==> There is not any detectable effect on the measurement from putting the
     CAT6 cable foil shield near the sensor.
 ==> Calibration not working on the cal_5_7/ dipole sensor data.  Something is
     weird. Oops, I logged the current sense data.  Probably that shouldn't
     happen. 


I think it may not really make sense to publish the dipole/quadrupole results
alone, even once updated, because of new understanding about the big effects
of coil interactions.  We could have published those results, but knowing what
we now know, that is a big omission.  In order to correctly make the argument
that the quadrupole effect measures the accuracy of the dipole approximation,
we need to eliminate any bigger errors.

I've been thinking about a paper on coil interactions and concentic
vs. non-concentric, effects of sensor load and source impedance, etc.  We
could roll this into one paper with dipole effects, or perhaps publish this
first.  




[7 May 21]

I implemented the coupling bias estimation scheme I described.  It
slightly reduces the calibration residual (which it would almost have
to), but somewhat hurts the RMS accuracy.  I'm not sure that it is
reasonable to estimate bias in this way, since the non-bias part of
the residual could have a non-zero mean.  The direct way to get the
bias would be by measuring with the shorted input.


[6 May 21]

I got one of the Premo sensors wired up, and getting the fixture post
fabricated.

I need a better understanding of the kinematics of error in the RxRy fixture.

The point of the mechanical alignment procedures is to try to make sure that
the stage kinematics is correct.  So Rz needs to intersect RxRy, etc.  The
sensor fixture pose then allows for the sensor to have an arbitrary pose wrt. the
stage.

But mechanical imprecision in the two mount points creates error.  In addition
to non-squareness causing non-intersection of the axes, translation error also
matters.  One way to model this would be as a sequential link between each of
the rotation axes.  If this includes rotation, then we can even model
non-orthogonality of the mechanical axes.  From the viewpoint of calibration,
this would amount to a more precise kinematics of the stage.

Non-square cross-section of the post or of the mount points also causes non-90
degree rotation, which would not be absorbed into link moments.

First, I would try testing how much of a problem this is, which can be done
mechanically.  All this kinematics seems like a lot of work, and also
absorbing even more DOF into discarded fixture effects seems like it could
absorb real errors.

One possibly test fixture would be a post with a pin sticking out sideways
along what is supposed to be the axis.  I guess you would need to shim the
base of the post to bring in the height to match the actual distance to the
center of rotation.  Can also test parallelism with the translation axes by
reading off the post, and off a square side arm.  OFC this is only an accurate
test insofar is the testing fixture is accurate.  This fixture could be
metal.  Tests for the relative pose of the two mount points can be done with
the sensor mount removed from the stage.

Probably the best way to tune the sensor mount fixture would be to make the
new test fixture, then make the mount agree with it by tweaking in the mount
points.  This potentially solves the height adustment problem, although
tweaking in all the critical faces without going too far is surely tricky.
Perhaps make a new mount rather than tweaking the old one.  I guess finish one
mount, then use the test fixture to bring in the other wrt. to it.

What is the magnitude of the effect of fixture error?  Angular error in the
mount points converts directly to angular error.  Angular error converts to
translation error according to the moment, which is mainly of a concern for
the post height.  This error is basically the non-intersection of the axes.
The moment is the post height, which is only 40mm or so.

What happens with angular errors at the sensor, eg. non-90 degree?  Does this
only affect the angular measurement? Aside from the actual mechanical effect,
there is some rotation->translation coupling in the pose solution itself, but
this effect should be small, so should be very small for a small angular
error.  At least at this point, we mainly want to test and reduce the
rotation->translation coupling seen for large rotations, whether this is
intrinsic in the tracker, or from stage kinematic error.

Looking at the error vectors, there seems to be something like a scale factor
error in Z, where at both + and - Z, the error vectors point inward.  For the
Y effect on error, this mainly seems to be increased magnitude and Rz
coupling, without any clear Y bias at any given point.


I tested the mutual inductance of my cube coil, and also the biggest premo
coil, using the inductance bridge and the shorting method.  Seems to be well
below 1e-3.  I expected higher, 1% or more, especially for my prototype coil.
I think a more sensitive test, especially for the source coil, is to drive in
a current, and then measure the short circuit current on the other axes.  I
could not see any null deflection with my coil, and there was only a just
noticeable deflection with the premo coils.



[4 May 21]

cal_5_3, ILEMT box, with capacitors ripped out.  Cal residue 3-e3.  Was like 4e-4 with Z-only.
________________________________________________________________
                d_source_pos                          d_source_moment                            d_sensor_pos                             d_sensor_moment           
    _____________________________________    __________________________________    ________________________________________    _____________________________________

      0.04597    -0.0010398             0    -0.91124    0.0041408            0      0.013859    -0.00029482              0        -0.18    -0.0029284             0
     0.002147      0.046098             0           0      0.93629            0    0.00018832       0.013518              0            0       0.17954             0
    -0.044444     -0.042867             0    0.030529      0.01112            1     -0.013818      -0.013672              0    0.0028949     0.0010959       0.17915

Source fix: [0.24980 0.02781 -0.03732 0.01354 0.01814 -1.56220 ]
Sensor fix: [0.00004 -0.00003 0.01375 0.00648 -0.00584 1.55604 ]

>> check_poses
data_file = 'Z_rot_ld.dat'
cal_file = 'XYZ_hr_cal.mat'

source_fix_delta =
  -1.0171e-05  -9.4135e-05   4.5581e-05  -0.00062529  -0.00091866     0.001284

sensor_fix_delta =
   9.4835e-05  -8.1182e-06   0.00027099    0.0032535  -7.0148e-05   -0.0035989

Position error (m): 4.14e-04 RMS, 1.43e-03 max.
Orientation error (radians): 3.52e-03 RMS, 1.06e-02 max

trans_err_rms =
   0.00015049   0.00025076   0.00029233

rot_err_rms =
    0.0015903    0.0017429    0.0026125
________________________________________________________________


Woot!  Error is greatly improved, and at 400 um RMS position error, we are
arguably within 2x of our 200 um goal.  (No longer recall whether we said RMS
or max.)  This is with only one fixturing, and will surely be worse with the
three rotations.  We may be nearing the level where ground truth inaccuracy
becomes an issue.

The calibration is somewhat prettier.  The sensor orthogonality is improved
about 2x.  Also, the sensor moment is 0.4x what it was.  This is somewhat
puzzling.  This must have been a gain boost from sensor resonance (which would
have also increased the sensor coil coupling).

Interesting that the source orthogonality is *not* way better compared to the
UR44 setup, even though that did not have off-axis compensation.  But there is
presumably actual non-orthogonality, or at least misalignment which can be
modelled as dipole, so minimizing off-axis terms is only something that is
"pretty". 


This is the "quadrupole" calibration:
________________________________________________________________

               d_source_pos                          d_source_moment                            d_sensor_pos                             d_sensor_moment           
    _____________________________________    __________________________________    ________________________________________    _____________________________________

      0.04597    -0.0010398             0    -0.91124    0.0041408            0      0.013859    -0.00029482              0        -0.18    -0.0029284             0
     0.002147      0.046098             0           0      0.93629            0    0.00018832       0.013518              0            0       0.17954             0
    -0.044444     -0.042867             0    0.030529      0.01112            1     -0.013818      -0.013672              0    0.0028949     0.0010959       0.17915

               q_source_pos                             q_source_moment                 q_sensor_pos    q_sensor_moment
    ___________________________________    _________________________________________    ____________    _______________

     0.097235     0.058666     0.058741      0.0022044    -0.00019983    -0.00050782    0    0    0       0    0    0  
     0.013613     0.065094     0.023188     2.5115e-05     -0.0021705    -6.1818e-05    0    0    0       0    0    0  
    -0.034986    -0.037858     0.006016    -0.00099234     0.00010038     -0.0023726    0    0    0       0    0    0  

Source fix: [0.24894 0.02782 -0.03683 0.01573 0.01695 -1.56067 ]
Sensor fix: [0.00004 -0.00003 0.01374 0.00653 -0.00585 1.55605 ]

>> check_poses
data_file = 'Z_rot_ld.dat'
cal_file = 'quadrupole_hr_cal.mat'

source_fix_delta =
  -1.4243e-05  -6.2832e-05    3.873e-05  -0.00072557  -0.00047574    0.0016535

sensor_fix_delta =
   9.6496e-05  -6.7973e-06   0.00026968    0.0032226  -0.00026451   -0.0037471

Position error (m): 4.28e-04 RMS, 1.42e-03 max.
Orientation error (radians): 3.47e-03 RMS, 9.29e-03 max

trans_err_rms =
   0.00015116   0.00026169   0.00030282

rot_err_rms =
    0.0014608    0.0016343    0.0026881
________________________________________________________________

This is a pretty unexciting improvement, translation RMS is actually slightly
worse, but rotation is improved a bit.  Cal residual reduced from 3.06e-3 down
to 2.84e-3.


Stage performace, from:
    http://filter.micron.ri.cmu.edu/wiki/doku.php?id=projects:asap:calibration:stage
________________________________________________________________

On-axis XYZ repeatability seems to be down around 1 um. Off-axis motion will
of course have both translation and rotation components, but it is difficult
to disentangle because any measurement setup has some moment about whatever
center of rotation there is. On the Z axis, X motion seemed to be within +/-5
um. Angular misalignment of the Z axis has been trimmed down to 100
microradians, at which point runout clearly dominates. Realistically it seems
that for runout + axis misalignment you can expect better than 1 milliradian
(1 micron per mm.) The XY orthogonality seems to be 600 microradians, which is
out of spec, and large enough that it could be affecting Micron
calibration. This would be easier to trim in software.
________________________________________________________________


Stage performance hasn't been directly checked since I wrote this in 2013, so
YMMV.  When compared to the current accuracy (400 um/3.5 mrad RMS), this seems
pretty good.  But need to consider pole moment effects and the RxRy fixture
error (Rz misalignment, etc.).  So far as the pole moment goes, the main issue
would be translation error due to translation->rotation coupling in the XYZ,
and Rz angular runout (Rz to Rx or Ry).

As quick check, If we say the moment is 300mm, then 1 mrad error would create
a 300um offset.  This is significant, so we need to get a better handle on
what we are actually seeing.

FWIW, we are currently getting sensor fixture XY offsets of 40 um.  Does this
reflect on the Rz alignment and RxRy fixture accuracy?  It nominally measures
how well the sensor Z moment is centered on the Rz axis (since the Z dipole
position is forced to 0).  It is not in principle a problem if this were
larger, but the small value is suggestive of actual accuracy.


 ==> I found a bug in the quadrupole forward kinematics which made it into a
     dipole; the two component dipoles did not have opposite signs.

Fixing this did not do much at all until I included dipole in the optimization
also.  With this change, we have so far made somewhat more progress on the
residue, but seem to have pretty much hit the wall at 2.7e-3 after 20
iterations.

Even so, the source X quadrupole moment is changing considerably.  Really need
to let it cook without watching too much, since intermediate states often
don't much resemble the final.
 ==> Conceivably the X quadrupole is bigger because we get closest to that
     coil.

Also, the quadrupole moments are kind of on-axis, but sign flipped.  Being
on-axis is what you would expect if this was absorbing the imperfect dipole
approximation of the ideal dipole-approximating coil geometry.  Or a
rotationally symmetric deviation due to the construction details.  The sensor
parameters (dipole only) don't seem to be changing much, so probably could
speed this up by dropping them out, IDK.  The fixture is not really changing
either, so it seems we are mainly trading the dipole and quadrupole terms
(which is what you would expect).  The dipole positions have moved by mm, and
the source fixture XY by 100's of um.

 ==> The X dipole and quadrupole positions have pretty much converged.

At the very least, I should be using the "medium size" data for calibration.
We may not have enough of the right poses to identify the quadrupole terms.
The way that the quadrupole keeps moving, without any significant effect on
the residual, suggests that we have excess DOF (at least given the data that
we have).  Nothing is "running away" that would give a clear indication, the
dipole components just keep creeping.


 ==> OK, the quadrupole optimization stopped after 88 iterations due to
     FunctionTolerance (failure to reduce the residual), residual 2.741e-3

________________________________________________________________
 
              d_source_pos                         d_source_moment                           d_sensor_pos                             d_sensor_moment           
    _____________________________________    ________________________________    ________________________________________    _____________________________________

      0.05127    -0.0020681             0    -0.89832    0.002791           0      0.013869    -0.00028474              0     -0.18096    -0.0029456             0
    0.0030322      0.044304             0           0     0.93925           0    0.00018272       0.013507              0            0       0.18046             0
    -0.044225      -0.04233             0    0.026178    0.011452           1     -0.013804      -0.013647              0    0.0028849     0.0010959       0.18011

               q_source_pos                           q_source_moment               q_sensor_pos    q_sensor_moment
    ___________________________________    _____________________________________    ____________    _______________

     0.055286     0.032516    -0.035511      0.92092    -0.0014976       0.11243    0    0    0       0    0    0  
    0.0030625    0.0077246      0.06798      0.16303      -0.13046       0.14168    0    0    0       0    0    0  
    -0.044637    -0.046113     0.014332    -0.014069      0.015162      -0.34999    0    0    0       0    0    0  

Source fix: [0.24993 0.02716 -0.03640 0.01553 0.01610 -1.56076 ]
Sensor fix: [0.00004 -0.00004 0.01373 0.00647 -0.00577 1.55603 ]

>> check_poses

data_file = 'Z_rot_ld.dat'
cal_file = 'all_hr_cal.mat'

source_fix_delta= 
  -5.1749e-05  -0.00014413   0.00021821   -0.0007071  -2.3414e-05   0.00044831

sensor_fix_delta =
   8.9371e-05   3.6453e-05   6.5274e-05    0.0031705  -0.00047694   -0.0030639

Position error (m): 3.95e-04 RMS, 1.37e-03 max.
Orientation error (radians): 3.19e-03 RMS, 1.23e-02 max

trans_err_rms =
   0.00013962   0.00023496   0.00028487

rot_err_rms =
    0.0013098    0.0014773    0.0025071
________________________________________________________________


So RMS error is modestly reduced, by 4.5% for position and 9.4% for
orientation.  Worst case error is not really helped, but this may be in part
because the calibration data does not cover the full test workspace (for Rz).
In the position error vectors, the pattern that we are worse at -Y is
maintained.  The Z pattern has become fairly symmetrical + and -, but error is
degraded significantly at the edges of the workspace.

The picture of the calibration is pretty similar to the non-final patterns
noted above.  The sensor parameters indeed hardly changed at all.  I can't
make much sense of how widely the quadrupole moments vary across the source
axes.  I am suspicious that we don't have the right calibration data.  The X
quadrupole seems physically plausible because it is largely on-axis and
located very near the dipole.  Well, all of XYZ moments are tend toward the
axis, and are opposite in sign to the dipole.  But the magnitudes are all over
the place, and the locations also seem somewhat random.


I was thinking that we could compensate the within-box out->in coupling by
calibrating an additive offset to the coupling matrix.  But this would
probably need to be a complex coupling because the internal coupling is likely
to be out of phase.  Also, this won't help the interference on the current
sense, eg. for off-axis compensation.  So it seems worthwhile to try magnetic
shielding around the input cards.
 ==> This is linear in the coupling, basically just the mean of the
     calibration residues.

Specificially, convert the predicted coupling back to complex, difference with
the measurement, and then take the mean.  This could be done separately, or
inside the calibrate objective, as an adjustment to the residues (forcing them
to zero mean).



[28-29 Apr 21]


re. working in the +X+Y+Z sector only.  I had thought of changing to the
symmetric diagonal source orientation back when we had identified the -Y
problem with Claudia, but then thought that this would create a problem with
our optimization constraint (currently +X).  True that we wouldn't get a
hemisphere anymore, only a 1/8 sphere.  But this is really fairly OK for our
application, and certainly fine as a temporary measure.

For source coil interfaction effects, it makes sense that operating at
negative coordinates would be worse, since in those poses there is an off-axis
coil between the source and the sensor.  Even with the off-axis current
nulled, there can still be interference due to eddy currents (that are not
along the wire, so are not measured).  *source* coil interaction can't explain
the Rz->XYZ coupling (especially in the Rz fixturing, where we rotate about
the coil axis), but sensor coil interaction might.


Coupling magnitude range:

The lowest norm of couplings in the large Rz data is 0.07 (-23 dB FS).  I had
previous measured the box internal cross coupling at -100 to -110 dB, or
1e-5.  This is about -77 dB wrt the min coupling magnitude, which would seem
to be a pretty good margin, except that this is more like the strongest
coupling in the matrix, rather than the weakest coupling that matters.  Given
that, more investigation would be needed to decide whether internal coupling
is a problem.  Our accuracy goal is around -60 dB (200 um @ 200 mm), so we
would want an error significantly less than -83 dB (-60 + -23).  -17 dB would
count as "significantly less", but given the very rough guess of what errors
matter, this is not conclusive.

There are very few measured couplings (any 3x3 position) which are <1e-3
re. FS.


Results with no off-axis compensation:

Not super confident in reproducibility because of that mysterious problem on
my cal_4_21 data, but in cal_4_28_nocomp the calibration residual is much
worse (4.9 vs 0.03?), and the tested accuracy is also worse.

cal_4_28_nocomp (ILEMT box, no off-axis comp), cal residual 4.9
________________________________________________________________

                  d_source_pos                             d_source_moment                           d_sensor_pos                           d_sensor_moment           
    _________________________________________    ___________________________________    ______________________________________    ____________________________________

       0.051667      0.0014064              0     -0.42598     0.040526            0       0.01434     0.0014069             0    -0.44582     -0.015227             0
    -0.00058553       0.046917              0            0      0.59241            0    8.4354e-06      0.014982             0           0       0.45084             0
      -0.044943      -0.044588              0    -0.017994     0.028224            1     -0.013824     -0.014159             0    0.015306    -0.0011999       0.44842

Source fix: [0.25647 0.01748 -0.02935 0.05066 0.00549 -1.60688 ]
Sensor fix: [0.00050 -0.00060 0.01437 0.01086 -0.00895 1.55384 ]

>> check_poses
source_fix_delta =
  -0.00023895  -0.00019102    0.0010144   -0.0019065    -0.005643   -0.0048901

sensor_fix_delta =
  -0.00032916  -0.00026563  -0.00032751    0.0025511    0.0042774   -0.0091584

Position error (m): 3.68e-03 RMS, 1.88e-02 max.
Orientation error (radians): 3.46e-02 RMS, 1.82e-01 max

trans_err_rms =
    0.0008643    0.0030645    0.0018373


rot_err_rms =
     0.013038     0.014659     0.028471
________________________________________________________________


Compare cal_4_23 (ILEMT box, with off-axis comp):
________________________________________________________________

               d_source_pos                           d_source_moment                             d_sensor_pos                            d_sensor_moment           
    _____________________________________    ____________________________________    ________________________________________    ____________________________________

     0.045587    -0.0014909             0     -0.4458    -0.0018872             0      0.013854    -1.0578e-05              0    -0.44857     -0.015882             0
    0.0025708      0.045895             0           0       0.58478             0    0.00022171       0.013749              0           0        0.4567             0
    -0.045172      -0.04339             0    0.011009     0.0042047             1      -0.01365      -0.013878              0    0.015513    -0.0049256       0.45367

Source fix: [0.24952 0.02950 -0.03737 0.01023 0.01238 -1.55465 ]
Sensor fix: [0.00009 -0.00020 0.01400 0.01996 -0.00422 1.54876 ]

>> check_poses
6 invalid points with residual > 0.0001.

bad_points =
     1     2     3     4     5     6

source_fix_delta =
   6.3395e-05  -4.2176e-05   0.00058952    0.0092933   -0.0060007    0.0039225

sensor_fix_delta =
   -3.043e-05  -0.00015105    0.0012648   -0.0062778   -0.0024586   -0.0063608

Position error (m): 2.35e-03 RMS, 1.19e-02 max.
Orientation error (radians): 2.28e-02 RMS, 1.13e-01 max

trans_err_rms =
   0.00057408    0.0018453    0.0013343

rot_err_rms =
    0.0096424     0.010984     0.017527
________________________________________________________________


cal_3_8 (UR44, no off-axis comp), cal residual 0.013
________________________________________________________________

                 d_source_pos                         d_source_moment                           d_sensor_pos                               d_sensor_moment             
    ______________________________________    ________________________________    ________________________________________    _________________________________________

       0.05073      0.002399             0      0.8922    0.062731           0      0.013907    -0.00033894              0       0.066321     -0.0021671              0
    0.00059686      0.047086             0           0     0.94211           0    9.6469e-05       0.013473              0              0        0.10677              0
     -0.043098     -0.042496             0    0.018888    0.042042           1     -0.013736      -0.013652              0    -0.00090121     0.00069743        0.10348

Source fix: [0.23029 0.00690 -0.03037 0.05172 0.01157 -1.59509 ]
Sensor fix: [0.00024 0.00006 0.01365 0.00598 -0.00761 1.55154 ]

>> check_poses

data_file =
    'Z_rot_ld.dat'

cal_file =
    'XYZ_hr_cal.mat'

source_fix_delta =
  -0.00037969   0.00054463  -9.6689e-05   -0.0062639    0.0012081   -0.0047747

sensor_fix_delta =
   0.00040664   0.00044483  -0.00019332    0.0029617    0.0018488     0.011777

Position error (m): 1.04e-03 RMS, 5.70e-03 max.
Orientation error (radians): 1.23e-02 RMS, 5.15e-02 max

trans_err_rms =
   0.00037492   0.00074372   0.00062078

rot_err_rms =
      0.00495    0.0058604    0.0096272

________________________________________________________________


So accuracy is better with off-axis cal than not using ILEMT box, but the old
UR44 setup is much better than either.

UR44:
Position error (m): 1.04e-03 RMS, 5.70e-03 max.
Orientation error (radians): 1.23e-02 RMS, 5.15e-02 max

ILEMT w/ off-axis:
Position error (m): 2.35e-03 RMS, 1.19e-02 max.
Orientation error (radians): 2.28e-02 RMS, 1.13e-01 max

ILEMT w/o off-axis:
Position error (m): 3.68e-03 RMS, 1.88e-02 max.
Orientation error (radians): 3.46e-02 RMS, 1.82e-01 max


I am strongly suspecting that the ILEMT box problem is increased load on the
sensor, especially the C load.  Would be interesting to measure on the UR44.

See ilemt_hw/docs/notebook.txt [29 Apr 21]


[27 Apr 21]

I collected the small three-fixture cal data again, and now that is basically
working also.  I must have goofed somehow with the cal_4_21 data.

But... The pose accuracy is *not* better than what we were getting with the
UR44, perhaps worse.  So far I have only tested with the "small" calibration,
either Rz only, or RzRyRz (dipole only)( And evaluated with various data,
either one of the "small" files, or an Rz big file.

The story is roughly similar with different test data.  With the three-fixture
calibration (vs Rz only), the error seems smoothed out more across the
workspace, not so concentrated along the -Y -Z edge.  Also (at least using the
Rz only big test data) it is clear that coupling from Rz to position is the
big contributor to position error.  That is, there is relatively little
tendency toward a general translation nonlinearity.  That is, the translation
errors at different Rz but the same XYZ are splayed out in all directions
(according to Rz), and not trending in a particular direction (independent of
Rz).

Y and Z error (from Rz cross coupling) are considerably larger than X.  Y
coordinate induced effect creates Y dispersion by Rz, and likewise Z creates Z
dispersion.

I tried quantifying the error pattern as a function of the desired pose, using
covariance, but it is not showing such a strong effect, I think perhaps
because the errors are splaying out somewhat evenly in all directions,
potentially cancelling out, and also the pattern of error magnitude increasing
away from the workspace center is a U-shape relation of error to position, so
is nonlinear.


What could be causing the calibration problem?

[A] Source side problems:
  (1) Coil nonideality, either as-built, or the dipole approximation
  (2) Coil interaction

[B] Sensor side problems:
  (1) Coil interaction
  (2) Coil nonideality, either as-built, or the dipole approximation

[C] Input issues:
  (1) Input load causing sensor coil interaction
  (2) Output -> input coupling inside the box
  (3) Input nonlinearity of measurement

[D] Environment:
  (1) magnetic interference (other than from coils)  The steel box itself?

[E] Ground truth problem:
  (1) error in stage kinematics: our command is wrong, or our expected result
      pose is wrong 
  (2) hardware problem in stage (much less likely)
  (3) motion_server problem

[F] Code problem:
  (1) Error in dipole forward kinematics (doesn't seem too likely)
  (2) Error in pose utilities
  (3) Labview signal processing or logging problem.  Is data stable during
      point data averaging?  Synch problem, increase settling time

[G] Physical/design:
  (1) Does error increase in configurations which are somehow unfavorable for
      the pose solution?  eg. something like singularity or observability.
  (2) Are outlier or difficult measurements throwing off the calibration
      process?
       ==> How are calibration residuals affected by pose?

[H] testing methods:
  (1) Is fixture pose optimization having a non-obvious effect?
       ==> Try using the original calibration fixture pose.


Thoughts:

[A](1), [B](2):
It doesn't make sense that coil nonideality would cause error to increase with
increasing source->sensor distance, since the dipole approximation improves
with distance.  Coil nonideality would almost certainly be larger for the
source, because the coils are larger.
 ==> Does error increase with distance?  How can we characterize the error
     variation? Magnitude of coupling or max coupling?
(The X effect on Rz coupling to Y,Z does seem to increase at lower X, eg. closer)

[C](2): coupling strength (distance) vs. error is also a test for inside-box
coupling, which would be most significant when the actual coupling is quite
small.

[G](1): More generally, look for any pattern in the couplings associated with
error.

[A](2) source cross coupling:
Not too keen on this because this seems to have been greatly reduced, and yet
did not help.
 ==> Take calibration and test data w/o source coupling compensation

(FWIW, the sensor moment non-orthogonality is now about the same as for the
source, a degree or so.  For the sensor, the moments trend away from the
adjacent coils, which is what you would expect for a conductive interferer.)

[B], [C]:
The dominant contribution to error from Rz suggests a sensor referred problem.
But we aren't rotating the source, so who knows what would happen then.
 ==> Take test data with source moved/rotated.  Unlikely to help, except
     perhaps for [D](1), but good to know, and we can do it now using
     check_poses().
 ==> Measure rotational response of coupling. eg. Z sensor coupling should not
     change with Rz.  If it does, then this really looks like a sensor error
     (like coil interaction).  But with off-axis moments, some variation is
     expected.  Can also do this test on X, Y coils in the other fixturings
     (but the sensor seems very symmetric).

[C](2):
Definitely investigate sensor coil interaction, which is one of the
few things I can think of that could explain the ILEMT box being worse (if it
is worse).
 ==> What is the effect of an extra sensor coil moved near the sensor?  Open,
     shorted, C load.
 ==> Any effect on coupling if we disconnect the other sensor axes from the
     input?
 ==> How does C load impedance compare to sensor output impedance?

[D](1):
 ==> Try moving the source, the box, the whole setup across the room, ... 
 ==> Check out low-rate calibration.  Is this better, worse, or the about the
     same? 
 ==> Sniff for interference using the old board test fixture.
 ==> Would be nice to have ilemt_ui feature to visualize small changes in
     field vector orientation.

[E](1): ground truth kinematics error:
 ==> Eyball desired pose
 ==> Some sort of round-trip check on the desired pose kinematics
 ==> We had that problem, with the new Corke toolbox not working, which we never
     investigated.  There could be a problem in our utilities, as well as the
     main code.
 ==> Eyeball/test fk_pose_calculation() and vector2tr()

[E](2) stage hardware:
 ==> Test for any mechanical XY motion as Rz is changed, when off center in XY
     plane.  (Already did this to some degree).
 ==> Don't think motion server actually errors if goal pose is not reached,
     though IIRC if there is a really big error then the labview API will error.

[F](1) dipole forward kinematics:
 ==> Test FK using synthetic data

General investigation:
 ==> Look at error visualizations directly incorporating rotation.  The
     linearity test cross coupling may be useful.  Also scatter plots
 ==> Try changing source/sensor fixture positioning so that we use only the
     +X+Y+Z sector.
 ==> Do we get substantially the same data on repeated identical collection
     runs?  With and without refixturing?
 ==> Matlab code issues should not change between old and new hardware.
 ==> Why does the X input seem inverted?  Might be a software problem.


Specific actions/tests:

High priority tests in lab:
 -- Check sensor coil interaction with extra coil, loaded
 -- Get data without source coupling compensation
 -- Try moving the box, wire, etc, look for effect on ilemt_ui
     ==> Effect of tipping box is nil, small effect when slid back off its
         rear feet, down onto motion rack. 
 -- Set up camera to monitor remote stage operation
 -- Try taking data in only the +X+Y+Z sector.  Rotate source so that the
    diagonal source coil symmetry axis is toward the workspace center.

High priority investigation:
 -- Is accuracy actually worse with new box, compared to Sayan's data?
    Sensor load and box out->in coupling are the most obvious ways that things
    could have gotten worse.  Or if source coupling compensation is actually
    bad.  Current results seem broadly similar to what Claudia got.  The lower
    error Claudia reported is at least partly explained by how we subsetted
    the data, IIRC removing the outer -Y plane.
 -- Look at pose error vs. coupling strength, or more generally, any coupling
    pattern related to error.
 -- Try low rate calibration

Other:
 ==> How are calibration residuals affected by pose?
 ==> Try using the original calibration fixture pose. (in check_poses)
 ==> Measure rotational response of coupling. eg. Z sensor coupling should not
     change with Rz.
[Not exhaustive, see all the ==> above]

Error checks to add:
 -- Propagate ilemt_ui errors (clip) into stage_calibration
 -- Check for excess final position error in motion_server.
 -- Add zero poses at beginning and end of test patterns for drift/bump
    check. 


[24 Apr 21]

Axis offsets:
-2.72	1.552	-3.8	0	0	1.4

Stage alignment check.

Alignment of fixture vertical with stage Z, proxy for normality between
fixture and Rz axis (which we are assuming is parallel to the Z translation
axis).  (Stage Rz @ 90 degrees)

Rx via 25mm Z move, indicated on back of post top mount:
    3 um

Ry via 30mm Z move, indicated on side of fixture post
    125 um


Rz alignment runout, taken at +90 Rz, -90 Rz and 0
	90:  0
	0:   0.031
	-90: 0.060

So basically it is off 30 um in both X and Y.  This is a measure of how
accurately the Rz axis intersects Rx Ry (with some assumption about the
accuracy of the fixtures).  Any non-intersection creates a
rotation->translation moment of the mismatch magnitude.

These alignments all seem fairly reasonable.  The only one that kind of rises
to the level of adjustment is the Ry alignment (pole sideways tip).  But this
has been very soft in the past, difficult to get it to stay below 100 um.
Now, these alignments could certainly contribute 100's of um error across the
workspace, which is a problem for evaluating the desired performance, but
can't explain the 

The Rz runout is going to cause an error of basically that runout. Simple
angular misalignment of the fixture wrt. the stage translation axes is not a
source of error, since the can be absorbed into the fixture transform.  But
non-normality of Rz with Rz Ry is also an error source.  This creates a
magnified error at the edge of the workspace because the points generated by
Rz rotation lie in a different plane that the fixture XY plane.  I guess this
is magnified by the moment ratio of the motion offset vs. the runout
measurment distance.  So over +/-50 mm we would expect about +/- 200 um
above/below the XY plane.

The same magnification would apply to any Rx Ry non-orthogonality (which so
far I have assumed is negligible).


[22 Apr 21]

I got calibration sort of working with data from the ILEMT box.  There seems
to be a sign flip on the sensor X, which is causing both the source and sensor
X moments to be sign flipped.  I recall that this was true with the UR44 also,
and I was negating the X signal in the UR44 settings.

The result calibration is very "pretty", with the off-axis components in the
source moments greatly reduced, and the source fixture also more nearly
aligned in rotation.  The sensor moment magnitudes are almost exactly the same
(because there are no gain knobs).

This is so far only working with the single Z fixturing.  Also, with Sayan's
cal_3_8 data using the UR44, I notice that using Z only gives a much lower
residual.  I am suspicious that I did not do the stage Rz alignment correctly,
since we restarted calibration work with Sayan.  Need to check that the Rz
motion is nulled when moving the stage in "Pose" mode, I had forgotten about
this distinction, and motion_ui defaults to "Absolute axis".


[20 Apr 21]

I did mechanical realignment of the stage.  For the stage vertical and Rz
zero, we were within maybe 500 microns or better on the sweeps of 50-100 mm.
The Rx XY position alignment, which I think is most critical, was off by
around 350 microns.
 ==> Getting the sensor mount zeroed wrt. Rz 0 does not matter at all, because
     we can fold that into the sensor fixture.  Getting the mount vertical is
     modestly important so that the Rz axis is orthogonal to Rx Ry.

What are we depending on for the Rx Ry refixturing to work?  I think it's
basically that the XYZ axes intersect and are orthogonal, where the X and Y
axis location are defined by the center of rotation of the sensor fixture.
Maybe the sensor fixture translation can absorb some of the XY offset of the
Rz axis?  IDK I think there is a problem because of the sequential kinematic
order, but we are simulating Rz being after translation in the kinematic
chain.

My feel is that we are lucky if our accuracy is 100 microns, and 200-300 is
more likely.  The pole is just super easy to bump even 100 microns sideways,
and during a Rz move the pole end tweaks by 10's of microns (though it seems
to settle back).

But at the level of error (mm max) we have gotten so far, I don't think the
ground truth accuracy is limiting.
 ==> With the revived test code with the fixture transform optimization, I can
     try accuracy test with just one fixturing.  This will avoid any
     refixturing error.
